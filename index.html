<!--
  ╔══════════════════════════════════════════════════════════════╗
  ║  APOLLO RISK ASSESSMENT FRAMEWORK — Arrephoros Technologies  ║
  ║  Version One: Corvus (Server-Side Auth)                      ║
  ╠══════════════════════════════════════════════════════════════╣
  ║                                                              ║
  ║  SETUP:                                                      ║
  ║  1. Create a Google Sheet named "Apollo"                     ║
  ║  2. Extensions → Apps Script → paste Apollo-Backend.gs       ║
  ║  3. Deploy → New Deployment → Web App                        ║
  ║     Execute as: Me, Access: Anyone                           ║
  ║  4. Copy the deployment URL into API_URL below               ║
  ║  5. Host this file (GitHub Pages, etc.) and embed            ║
  ║                                                              ║
  ║  DEFAULT ADMIN (auto-seeded on first server request):        ║
  ║  Username: SYSADMIN   Password: arrephoros                   ║
  ║                                                              ║
  ╚══════════════════════════════════════════════════════════════╝
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apollo — Risk Assessment Framework</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#ffffff;--bg-secondary:#f5f5f7;--bg-tertiary:#fafafa;
  --card:#ffffff;--card-hover:#fafafa;
  --red:#e53935;--red-light:#ffebee;--red-dark:#c62828;
  --green:#43a047;--green-light:#e8f5e9;
  --amber:#f9a825;--amber-light:#fff8e1;
  --orange:#ef6c00;--orange-light:#fff3e0;
  --danger:#d32f2f;--danger-light:#ffebee;
  --text:#1d1d1f;--text-secondary:#6e6e73;--text-tertiary:#86868b;
  --border:#d2d2d7;--border-light:#e8e8ed;
  --font:'Inter',system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
  --radius:12px;--radius-sm:8px;--radius-lg:16px;
  --shadow:0 1px 3px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);
  --shadow-md:0 4px 12px rgba(0,0,0,.08),0 1px 3px rgba(0,0,0,.06);
  --shadow-lg:0 12px 40px rgba(0,0,0,.1),0 4px 12px rgba(0,0,0,.06);
}
html,body{height:100%;overflow:hidden;background:var(--bg-secondary);color:var(--text);font-family:var(--font);font-size:15px;line-height:1.6;-webkit-font-smoothing:antialiased}

/* ── SCREENS ── */
.screen{position:fixed;inset:0;z-index:10;display:none;flex-direction:column;align-items:center;justify-content:center;padding:24px;overflow-y:auto}
.screen.active{display:flex}

/* ── CARD ── */
.card{background:var(--card);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);padding:40px;max-width:480px;width:100%}
.card-wide{max-width:640px}

/* ── LOGO ── */
.logo{width:64px;height:64px;margin:0 auto 20px}
.logo-sm{width:32px;height:32px}
.logo svg{width:100%;height:100%}

/* ── TYPOGRAPHY ── */
h1{font-size:28px;font-weight:700;letter-spacing:-.02em;color:var(--text)}
h2{font-size:20px;font-weight:600;letter-spacing:-.01em;color:var(--text)}
h3{font-size:15px;font-weight:600;color:var(--text)}
.subtitle{font-size:14px;color:var(--text-secondary);font-weight:400;margin-top:4px}
.caption{font-size:12px;color:var(--text-tertiary);font-weight:500;text-transform:uppercase;letter-spacing:.06em}
.version-tag{display:inline-block;font-size:11px;font-weight:600;color:var(--text-tertiary);background:var(--bg-secondary);border-radius:6px;padding:2px 8px;letter-spacing:.04em;text-transform:uppercase;margin-top:8px}

/* ── FORM ── */
.field{margin-bottom:16px}
.field label{display:block;font-size:13px;font-weight:500;color:var(--text-secondary);margin-bottom:6px}
.field input,.field select,.field textarea{width:100%;background:var(--bg-secondary);border:1px solid var(--border-light);color:var(--text);padding:11px 14px;font-family:var(--font);font-size:15px;border-radius:var(--radius-sm);outline:none;transition:border-color .2s,box-shadow .2s}
.field input:focus,.field select:focus{border-color:var(--red);box-shadow:0 0 0 3px rgba(229,57,53,.12)}
.field input::placeholder{color:var(--text-tertiary)}

/* ── BUTTONS ── */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:11px 24px;font-family:var(--font);font-size:14px;font-weight:600;border:none;border-radius:var(--radius-sm);cursor:pointer;transition:all .2s;gap:6px}
.btn-primary{background:var(--red);color:#fff}
.btn-primary:hover{background:var(--red-dark);box-shadow:var(--shadow-md)}
.btn-primary:disabled{opacity:.5;cursor:not-allowed}
.btn-secondary{background:var(--bg-secondary);color:var(--text);border:1px solid var(--border)}
.btn-secondary:hover{background:var(--border-light)}
.btn-danger{background:var(--danger-light);color:var(--danger);border:1px solid transparent}
.btn-danger:hover{background:var(--danger);color:#fff}
.btn-sm{padding:7px 14px;font-size:13px;border-radius:6px}
.btn-full{width:100%}
.btn-ghost{background:transparent;color:var(--text-secondary);padding:7px 12px}
.btn-ghost:hover{background:var(--bg-secondary);color:var(--text)}

/* ── YES/NO TOGGLE ── */
.yn-group{display:flex;gap:8px;margin-top:8px}
.yn-btn{flex:1;padding:10px;text-align:center;border:1px solid var(--border-light);color:var(--text-secondary);font-family:var(--font);font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;border-radius:var(--radius-sm);background:var(--bg-tertiary)}
.yn-btn:hover{border-color:var(--border);background:var(--bg-secondary)}
.yn-btn.sel-yes{border-color:var(--red);color:var(--red);background:var(--red-light)}
.yn-btn.sel-no{border-color:var(--green);color:var(--green);background:var(--green-light)}

/* ── QUESTION BLOCK ── */
.q-block{padding:16px;border-radius:var(--radius-sm);background:var(--bg-tertiary);margin-bottom:12px;transition:all .3s}
.q-block.hidden{display:none}
.q-block .q-id{font-size:11px;font-weight:600;color:var(--red);text-transform:uppercase;letter-spacing:.06em;margin-bottom:4px}
.q-block .q-text{font-size:14px;color:var(--text);line-height:1.5}
.q-block .q-note{font-size:13px;color:var(--text-tertiary);margin-top:6px;line-height:1.5}

/* ── SLIDER ── */
input[type=range]{-webkit-appearance:none;width:100%;height:6px;background:var(--border-light);outline:none;border-radius:3px;margin:8px 0}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:20px;height:20px;background:var(--red);border-radius:50%;cursor:pointer;box-shadow:var(--shadow)}
.severity-val{font-weight:600;color:var(--red);font-size:14px;text-align:right}

/* ── PROGRESS BAR ── */
.progress-bar{width:100%;height:4px;background:var(--border-light);border-radius:2px;margin-bottom:24px;overflow:hidden}
.progress-bar .fill{height:100%;background:var(--red);transition:width .4s ease;border-radius:2px}

/* ── TABLE ── */
.user-table{width:100%;border-collapse:collapse;margin:12px 0}
.user-table th,.user-table td{padding:10px 14px;text-align:left;border-bottom:1px solid var(--border-light);font-size:14px}
.user-table th{color:var(--text-tertiary);font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.05em}
.user-table tr:hover td{background:var(--bg-tertiary)}

/* ── BADGE ── */
.badge{display:inline-block;padding:3px 10px;font-size:12px;font-weight:600;border-radius:20px}
.badge-active{background:var(--green-light);color:var(--green)}

/* ── RESULTS ── */
.result-box{text-align:center;padding:40px 24px}
.result-score{font-size:56px;font-weight:700;color:var(--text);letter-spacing:-.03em}
.result-level-num{font-size:72px;font-weight:800;line-height:1;letter-spacing:-.03em}
.result-level-desc{font-size:17px;font-weight:600;letter-spacing:.02em;text-transform:uppercase;margin-top:8px;color:var(--text-secondary)}
.result-breakdown{text-align:left;margin-top:28px;padding:20px;border:1px solid var(--border-light);border-radius:var(--radius);font-size:14px}
.result-breakdown .rb-row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid var(--border-light)}
.result-breakdown .rb-row:last-child{border-bottom:none}
.result-breakdown .rb-row span:first-child{color:var(--text-secondary)}
.result-breakdown .rb-row span:last-child{font-weight:600;color:var(--text)}

/* ── RISK COLORS ── */
.risk-1{color:var(--green)}.risk-2{color:var(--amber)}.risk-3{color:var(--orange)}.risk-4{color:#e53935}.risk-5{color:var(--danger)}
.risk-border-1{border-color:var(--green)}.risk-border-2{border-color:var(--amber)}.risk-border-3{border-color:var(--orange)}
.risk-border-4{border-color:#e53935}.risk-border-5{border-color:var(--danger)}

/* ── LOADING ── */
#loadingOverlay{position:fixed;inset:0;z-index:10000;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity .5s}
#loadingOverlay.fade-out{opacity:0;pointer-events:none}
.loader-ring{width:40px;height:40px;border:3px solid var(--border-light);border-top-color:var(--red);border-radius:50%;animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* ── SCROLLBAR ── */
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--text-tertiary)}

/* ── SECTION DIVIDER ── */
.divider{height:1px;background:var(--border-light);margin:20px 0}

/* ── HELPERS ── */
.mt-4{margin-top:4px}.mt-8{margin-top:8px}.mt-12{margin-top:12px}.mt-16{margin-top:16px}.mt-20{margin-top:20px}.mt-24{margin-top:24px}
.mb-4{margin-bottom:4px}.mb-8{margin-bottom:8px}.mb-12{margin-bottom:12px}.mb-16{margin-bottom:16px}
.text-center{text-align:center}
.text-red{color:var(--red)}.text-secondary{color:var(--text-secondary)}
.flex-row{display:flex;gap:8px;align-items:center}
.error-msg{color:var(--danger);font-size:13px;font-weight:500;min-height:20px;margin-top:8px}
.assess-container{max-height:calc(100vh - 160px);overflow-y:auto;padding-right:4px}

/* ── ANIMATE ── */
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.animate-in{animation:fadeUp .4s ease forwards}

/* ── PANEL SECTION ── */
.panel-section{padding:20px;border:1px solid var(--border-light);border-radius:var(--radius);margin-bottom:16px}
</style>
</head>
<body>

<!-- LOADING -->
<div id="loadingOverlay">
  <div class="logo" style="margin-bottom:24px"><svg viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
    <circle cx="100" cy="100" r="96" fill="#e53935"/>
    <path d="M70 55 Q65 35 80 40 Q90 28 100 25 Q110 28 120 40 Q135 35 130 55" fill="white"/>
    <ellipse cx="100" cy="95" rx="48" ry="55" fill="white"/>
    <ellipse cx="82" cy="85" rx="18" ry="20" fill="#e53935"/>
    <ellipse cx="118" cy="85" rx="18" ry="20" fill="#e53935"/>
    <circle cx="82" cy="85" r="9" fill="white"/>
    <circle cx="118" cy="85" r="9" fill="white"/>
    <circle cx="82" cy="85" r="5" fill="#1d1d1f"/>
    <circle cx="118" cy="85" r="5" fill="#1d1d1f"/>
    <path d="M94 100 L100 110 L106 100" stroke="#e53935" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
    <path d="M75 120 Q100 145 125 120" stroke="#e53935" stroke-width="2" fill="none" opacity=".3"/>
  </svg></div>
  <div class="loader-ring"></div>
</div>

<!-- ═══════════ LOGIN SCREEN ═══════════ -->
<div class="screen active" id="loginScreen">
  <div class="card" style="max-width:400px">
    <div class="text-center">
      <div class="logo"><svg viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="100" cy="100" r="96" fill="#e53935"/>
        <path d="M70 55 Q65 35 80 40 Q90 28 100 25 Q110 28 120 40 Q135 35 130 55" fill="white"/>
        <ellipse cx="100" cy="95" rx="48" ry="55" fill="white"/>
        <ellipse cx="82" cy="85" rx="18" ry="20" fill="#e53935"/>
        <ellipse cx="118" cy="85" rx="18" ry="20" fill="#e53935"/>
        <circle cx="82" cy="85" r="9" fill="white"/>
        <circle cx="118" cy="85" r="9" fill="white"/>
        <circle cx="82" cy="85" r="5" fill="#1d1d1f"/>
        <circle cx="118" cy="85" r="5" fill="#1d1d1f"/>
        <path d="M94 100 L100 110 L106 100" stroke="#e53935" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        <path d="M75 120 Q100 145 125 120" stroke="#e53935" stroke-width="2" fill="none" opacity=".3"/>
      </svg></div>
      <h1>Apollo</h1>
      <p class="subtitle">Risk Assessment Framework</p>
      <div class="version-tag">Corvus</div>
    </div>
    <div style="margin-top:28px">
      <div class="field"><label>Username</label><input type="text" id="loginUser" placeholder="Enter your username" autocomplete="off"></div>
      <div class="field"><label>Password</label><input type="password" id="loginPass" placeholder="Enter your password" autocomplete="off"></div>
      <div class="error-msg" id="loginErr"></div>
      <button class="btn btn-primary btn-full" onclick="doLogin()">Sign In</button>
    </div>
    <p class="text-center mt-16" style="font-size:12px;color:var(--text-tertiary)">Arrephoros Technologies PLC</p>
  </div>
</div>

<!-- ═══════════ ADMIN SCREEN ═══════════ -->
<div class="screen" id="adminScreen">
  <div class="card card-wide">
    <div class="flex-row" style="justify-content:space-between;margin-bottom:24px">
      <div class="flex-row">
        <div class="logo-sm"><svg viewBox="0 0 200 200" fill="none"><circle cx="100" cy="100" r="96" fill="#e53935"/><path d="M70 55 Q65 35 80 40 Q90 28 100 25 Q110 28 120 40 Q135 35 130 55" fill="white"/><ellipse cx="100" cy="95" rx="48" ry="55" fill="white"/><ellipse cx="82" cy="85" rx="18" ry="20" fill="#e53935"/><ellipse cx="118" cy="85" rx="18" ry="20" fill="#e53935"/><circle cx="82" cy="85" r="9" fill="white"/><circle cx="118" cy="85" r="9" fill="white"/><circle cx="82" cy="85" r="5" fill="#1d1d1f"/><circle cx="118" cy="85" r="5" fill="#1d1d1f"/><path d="M94 100 L100 110 L106 100" stroke="#e53935" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg></div>
        <h2>Administration</h2>
      </div>
      <button class="btn btn-ghost btn-sm" onclick="doLogout()">Sign Out</button>
    </div>

    <!-- Add User -->
    <div class="panel-section">
      <h3 class="mb-12">Add Operative</h3>
      <div class="flex-row" style="gap:10px;flex-wrap:wrap">
        <div class="field" style="flex:1;min-width:140px;margin-bottom:0"><input id="newUser" placeholder="Username"></div>
        <div class="field" style="flex:1;min-width:140px;margin-bottom:0"><input id="newPass" type="password" placeholder="Password"></div>
        <button class="btn btn-primary btn-sm" onclick="addUser()">Add</button>
      </div>
      <div class="error-msg" id="adminErr"></div>
    </div>

    <!-- User List -->
    <div style="max-height:240px;overflow-y:auto">
      <table class="user-table">
        <thead><tr><th>Operative</th><th>Status</th><th>Action</th></tr></thead>
        <tbody id="userTableBody"></tbody>
      </table>
    </div>

    <!-- Change Admin Pass -->
    <div class="panel-section" style="margin-top:16px;margin-bottom:0">
      <h3 class="mb-12">Change Admin Password</h3>
      <div class="flex-row" style="gap:10px">
        <div class="field" style="flex:1;margin-bottom:0"><input id="newAdminPass" type="password" placeholder="New password"></div>
        <button class="btn btn-danger btn-sm" onclick="changeAdminPass()">Update</button>
      </div>
      <div class="error-msg" id="adminPassErr"></div>
    </div>
  </div>
</div>

<!-- ═══════════ ASSESSMENT SCREEN ═══════════ -->
<div class="screen" id="assessScreen">
  <div class="card card-wide">
    <div class="flex-row" style="justify-content:space-between;margin-bottom:4px">
      <div class="flex-row">
        <div class="logo-sm"><svg viewBox="0 0 200 200" fill="none"><circle cx="100" cy="100" r="96" fill="#e53935"/><path d="M70 55 Q65 35 80 40 Q90 28 100 25 Q110 28 120 40 Q135 35 130 55" fill="white"/><ellipse cx="100" cy="95" rx="48" ry="55" fill="white"/><ellipse cx="82" cy="85" rx="18" ry="20" fill="#e53935"/><ellipse cx="118" cy="85" rx="18" ry="20" fill="#e53935"/><circle cx="82" cy="85" r="9" fill="white"/><circle cx="118" cy="85" r="9" fill="white"/><circle cx="82" cy="85" r="5" fill="#1d1d1f"/><circle cx="118" cy="85" r="5" fill="#1d1d1f"/><path d="M94 100 L100 110 L106 100" stroke="#e53935" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg></div>
        <h2>Apollo</h2>
      </div>
      <button class="btn btn-ghost btn-sm" onclick="doLogout()">Sign Out</button>
    </div>
    <div class="progress-bar"><div class="fill" id="progressFill" style="width:0%"></div></div>

    <div class="assess-container" id="assessContainer">
      <!-- Step 0: Subject Intake -->
      <div class="assess-step active" id="step0">
        <h3 class="mb-16">Subject Intake</h3>
        <div class="field"><label>Subject Name / Identifier</label><input id="suspectName" placeholder="Enter subject name"></div>
        <div class="field"><label>Assessment Period (Days)</label><input id="assessPeriod" type="number" min="1" max="30" value="7" placeholder="1-30"></div>
        <div class="field"><label>Jurisdiction</label><input id="jurisdiction" placeholder="Enter jurisdiction"></div>
        <div class="field"><label>Investigating Operative</label><input id="investigator" readonly></div>
      </div>

      <!-- Step 1: Section 1 Conduct -->
      <div class="assess-step" id="step1" style="display:none">
        <h3 class="mb-16">Section One — Conduct</h3>
        <div class="q-block" id="q1_1_block">
          <div class="q-id">1.1</div>
          <div class="q-text">Has the suspect been exhibiting negative behavior in their contact with your service?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_1',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q1_1',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q1_2_block">
          <div class="q-id">1.2</div>
          <div class="q-text">Has the suspect been exhibiting negative behavior towards members of the general population?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_2',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q1_2',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q1_2d_block">
          <div class="q-id">1.2 — Supplementary</div>
          <div class="q-text">Has the suspect acted discriminatorily towards any member for their association with or membership within a protected class in your jurisdiction?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_2d',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q1_2d',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q1_slur_block">
          <div class="q-id">1 — Slurs Addendum</div>
          <div class="q-text">Has the suspect used slurs in their speech during the term of investigation?</div>
          <div class="q-note">This does not include commonly understood expletive phrases, but a pejorative, derogatory, or insulting word/phrase designed to demean, belittle, or show contempt toward individuals or groups based on race, ethnicity, sexual orientation, gender, or other characteristics.</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_slur',true,this)">Yes (+2)</div><div class="yn-btn" onclick="setYN('q1_slur',false,this)">No</div></div>
        </div>
      </div>

      <!-- Step 2: Section 2 Prior Offences -->
      <div class="assess-step" id="step2" style="display:none">
        <h3 class="mb-16">Section Two — Prior Offences</h3>
        <div class="q-block" id="q2_1_block">
          <div class="q-id">2.1</div>
          <div class="q-text">Has the suspect been convicted of any prior offenses inside or outside of your jurisdiction?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_1',true,this)">Yes</div><div class="yn-btn" onclick="setYN('q2_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_2_block">
          <div class="q-id">2.2</div>
          <div class="q-text">How many times has the suspect been convicted?</div>
          <div class="field" style="margin-bottom:0;margin-top:8px"><input id="q2_convictions" type="number" min="1" max="50" value="1" onchange="buildSeverityInputs()" oninput="buildSeverityInputs()"></div>
        </div>
        <div class="q-block hidden" id="q2_3_block">
          <div class="q-id">2.3</div>
          <div class="q-text">Rate the severity of each offense (0 = minimal, 1 = maximum severity):</div>
          <div id="severityContainer"></div>
        </div>
        <div class="q-block hidden" id="q2_4_block">
          <div class="q-id">2.4</div>
          <div class="q-text">Has the suspect been banned from your jurisdiction for any of these convictions?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4',true,this)">Yes (+2)</div><div class="yn-btn" onclick="setYN('q2_4',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_4_1_block">
          <div class="q-id">2.4.1</div>
          <div class="q-text">Has the suspect been banned for more than two months?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4_1',true,this)">Yes (+0.5)</div><div class="yn-btn" onclick="setYN('q2_4_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_4_2_block">
          <div class="q-id">2.4.2</div>
          <div class="q-text">Has the suspect been banned for more than six months?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4_2',true,this)">Yes (+1.0)</div><div class="yn-btn" onclick="setYN('q2_4_2',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_4_3_block">
          <div class="q-id">2.4.3</div>
          <div class="q-text">Has the suspect been banned for more than one year?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4_3',true,this)">Yes (+2.5)</div><div class="yn-btn" onclick="setYN('q2_4_3',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_5_block">
          <div class="q-id">2.5</div>
          <div class="q-text">Has the suspect been convicted prior to this assessment period for the suspected crime?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_5',true,this)">Yes (+1.5)</div><div class="yn-btn" onclick="setYN('q2_5',false,this)">No</div></div>
        </div>
      </div>

      <!-- Step 3: Section 3 Demeanour -->
      <div class="assess-step" id="step3" style="display:none">
        <h3 class="mb-16">Section Three — Demeanour</h3>
        <div class="q-block" id="q3_1_block">
          <div class="q-id">3.1</div>
          <div class="q-text">Has the suspect been acting in a manner that is different from their usual demeanor?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q3_1',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q3_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q3_1_1_block">
          <div class="q-id">3.1.1</div>
          <div class="q-text">Does this shift in demeanour have a reasonable and known or documented explanation?</div>
          <div class="q-note">If yes, subtract 1 point. If no, add 1.5 points.</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q3_1_1',true,this)">Yes (-1)</div><div class="yn-btn" onclick="setYN('q3_1_1',false,this)">No (+1.5)</div></div>
        </div>
      </div>

      <!-- Step 4: Section 4 Mediating Factors -->
      <div class="assess-step" id="step4" style="display:none">
        <h3 class="mb-16">Section Four — Mediating Factors</h3>
        <div class="q-block" id="q4_1_block">
          <div class="q-id">4.1</div>
          <div class="q-text">At the time of investigation, was or is the suspect a member of your government?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_1',true,this)">Yes (-1)</div><div class="yn-btn" onclick="setYN('q4_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q4_1_1_block">
          <div class="q-id">4.1.1</div>
          <div class="q-text">Is the suspect being investigated for crimes committed while in office?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_1_1',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q4_1_1',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q4_2_block">
          <div class="q-id">4.2</div>
          <div class="q-text">Is the suspect generally well liked, not just by you, but by the jurisdiction's community?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_2',true,this)">Yes (-1)</div><div class="yn-btn" onclick="setYN('q4_2',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q4_3_block">
          <div class="q-id">4.3</div>
          <div class="q-text">If the investigation was initiated because of general knowledge that a crime has been committed, or the mere suspicion a crime has been committed without direct evidence, which you aim to gain through further investigation:</div>
          <div class="q-note">If yes, subtract 3 points. This accounts for low-evidence preliminary investigations.</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_3',true,this)">Yes (-3)</div><div class="yn-btn" onclick="setYN('q4_3',false,this)">No</div></div>
        </div>
      </div>
    </div>

    <!-- NAV -->
    <div class="flex-row mt-20" style="justify-content:space-between" id="assessNav">
      <button class="btn btn-secondary btn-sm" id="prevBtn" onclick="assessNav(-1)" style="visibility:hidden">&larr; Previous</button>
      <button class="btn btn-primary btn-sm" id="nextBtn" onclick="assessNav(1)">Next &rarr;</button>
    </div>
  </div>
</div>

<!-- ═══════════ RESULTS SCREEN ═══════════ -->
<div class="screen" id="resultScreen">
  <div class="card card-wide" id="resultPanel">
    <div class="text-center mb-16">
      <div class="logo"><svg viewBox="0 0 200 200" fill="none"><circle cx="100" cy="100" r="96" fill="#e53935"/><path d="M70 55 Q65 35 80 40 Q90 28 100 25 Q110 28 120 40 Q135 35 130 55" fill="white"/><ellipse cx="100" cy="95" rx="48" ry="55" fill="white"/><ellipse cx="82" cy="85" rx="18" ry="20" fill="#e53935"/><ellipse cx="118" cy="85" rx="18" ry="20" fill="#e53935"/><circle cx="82" cy="85" r="9" fill="white"/><circle cx="118" cy="85" r="9" fill="white"/><circle cx="82" cy="85" r="5" fill="#1d1d1f"/><circle cx="118" cy="85" r="5" fill="#1d1d1f"/><path d="M94 100 L100 110 L106 100" stroke="#e53935" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg></div>
    </div>
    <div id="resultContent"></div>
    <div class="flex-row mt-24" style="justify-content:center;gap:12px">
      <button class="btn btn-primary btn-sm" onclick="newAssessment()">New Assessment</button>
      <button class="btn btn-secondary btn-sm" onclick="printResult()">Export Report</button>
    </div>
  </div>
</div>

<script>
// ═══════════════════════════════════════
//  APOLLO FRAMEWORK — CORE ENGINE
//  Version One: Corvus (Server-Side Auth)
// ═══════════════════════════════════════

// ╔═══════════════════════════════════════════════════════════╗
// ║  PASTE YOUR APPS SCRIPT DEPLOYMENT URL BELOW             ║
// ╚═══════════════════════════════════════════════════════════╝
const API_URL = 'https://script.google.com/macros/s/AKfycbwBgQtsL7uavYTMd2PacrZA__nijMI0MsrRUX0L2rfeLj5ofVRg-hYDc3NFexdhRLJY/exec';

const TOKEN_KEY = 'apollo_session_token';

// ── API HELPER ──
async function api(action, params = {}) {
  const body = Object.assign({ action }, params);
  const token = localStorage.getItem(TOKEN_KEY);
  if (token) body.token = token;
  const res = await fetch(API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    body: JSON.stringify(body)
  });
  return res.json();
}

// ── BUTTON LOADING STATES ──
function btnLoading(btn, loading) {
  if (loading) {
    btn.dataset.origText = btn.textContent;
    btn.textContent = 'Processing...';
    btn.disabled = true;
    btn.style.opacity = '0.5';
  } else {
    btn.textContent = btn.dataset.origText || btn.textContent;
    btn.disabled = false;
    btn.style.opacity = '1';
  }
}

// ── INIT ──
async function init() {
  document.getElementById('loginUser').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });
  document.getElementById('loginPass').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });

  const token = localStorage.getItem(TOKEN_KEY);
  if (token) {
    try {
      const res = await api('validate', { token });
      if (res.ok) {
        currentUser = res.username;
        currentRole = res.role;
        if (res.role === 'admin') { showScreen('adminScreen'); refreshUserTable(); }
        else { document.getElementById('investigator').value = res.username; showScreen('assessScreen'); }
      } else {
        localStorage.removeItem(TOKEN_KEY);
      }
    } catch (e) {
      localStorage.removeItem(TOKEN_KEY);
    }
  }

  setTimeout(() => { document.getElementById('loadingOverlay').classList.add('fade-out'); }, 600);
}

let currentUser = null;
let currentRole = null;
let currentStep = 0;
const totalSteps = 5;
let answers = {};

// ── AUTH ──
async function doLogin() {
  const u = document.getElementById('loginUser').value.trim();
  const p = document.getElementById('loginPass').value;
  const err = document.getElementById('loginErr');
  err.textContent = '';
  if (!u || !p) { err.textContent = 'All fields required.'; return; }

  const btn = document.querySelector('#loginScreen .btn-primary');
  btnLoading(btn, true);

  try {
    const res = await api('login', { username: u, password: p });
    if (res.ok) {
      localStorage.setItem(TOKEN_KEY, res.token);
      currentUser = u;
      currentRole = res.role;
      if (res.role === 'admin') { showScreen('adminScreen'); refreshUserTable(); }
      else { document.getElementById('investigator').value = u; showScreen('assessScreen'); }
    } else {
      err.textContent = res.error || 'Invalid credentials.';
    }
  } catch (e) {
    err.textContent = 'Unable to reach server.';
  } finally {
    btnLoading(btn, false);
  }
}

async function doLogout() {
  const btn = event ? event.target : null;
  if (btn) btnLoading(btn, true);

  try { await api('logout'); } catch (e) {}

  localStorage.removeItem(TOKEN_KEY);
  currentUser = null;
  currentRole = null;
  resetAssessment();
  showScreen('loginScreen');
  document.getElementById('loginUser').value = '';
  document.getElementById('loginPass').value = '';
  document.getElementById('loginErr').textContent = '';
  if (btn) btnLoading(btn, false);
}

// ── ADMIN ──
async function addUser() {
  const u = document.getElementById('newUser').value.trim();
  const p = document.getElementById('newPass').value;
  const err = document.getElementById('adminErr');
  err.textContent = '';
  if (!u || !p) { err.textContent = 'Username and password required.'; return; }

  const btn = document.querySelector('#adminScreen .btn-primary');
  btnLoading(btn, true);

  try {
    const res = await api('adduser', { username: u, password: p });
    if (res.ok) {
      document.getElementById('newUser').value = '';
      document.getElementById('newPass').value = '';
      refreshUserTable();
    } else {
      err.textContent = res.error || 'Failed to add user.';
    }
  } catch (e) {
    err.textContent = 'Unable to reach server.';
  } finally {
    btnLoading(btn, false);
  }
}

async function removeUser(username) {
  try {
    const res = await api('removeuser', { username });
    if (!res.ok) { alert(res.error || 'Failed to remove user.'); }
    refreshUserTable();
  } catch (e) {
    alert('Unable to reach server.');
  }
}

async function changeAdminPass() {
  const p = document.getElementById('newAdminPass').value;
  const err = document.getElementById('adminPassErr');
  err.textContent = '';
  err.style.color = '';
  if (!p || p.length < 4) { err.textContent = 'Password must be at least 4 characters.'; return; }

  const btn = document.querySelector('#adminScreen .btn-danger');
  btnLoading(btn, true);

  try {
    const res = await api('changeadminpass', { newPassword: p });
    if (res.ok) {
      document.getElementById('newAdminPass').value = '';
      err.style.color = 'var(--green)';
      err.textContent = 'Password updated.';
      setTimeout(() => { err.textContent = ''; err.style.color = ''; }, 2000);
    } else {
      err.textContent = res.error || 'Failed to update password.';
    }
  } catch (e) {
    err.textContent = 'Unable to reach server.';
  } finally {
    btnLoading(btn, false);
  }
}

async function refreshUserTable() {
  const tbody = document.getElementById('userTableBody');
  tbody.innerHTML = '<tr><td colspan="3" style="color:var(--text-tertiary);text-align:center;padding:20px">Loading...</td></tr>';

  try {
    const res = await api('listusers');
    tbody.innerHTML = '';
    if (!res.ok) { tbody.innerHTML = '<tr><td colspan="3" style="color:var(--danger);text-align:center">' + (res.error || 'Error') + '</td></tr>'; return; }
    const users = res.users.filter(u => u.role !== 'admin');
    if (!users.length) { tbody.innerHTML = '<tr><td colspan="3" style="color:var(--text-tertiary);text-align:center;padding:20px">No operatives registered</td></tr>'; return; }
    users.forEach(u => {
      const tr = document.createElement('tr');
      const safeName = u.username.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]));
      tr.innerHTML = '<td>' + safeName + '</td><td><span class="badge badge-active">Active</span></td><td><button class="btn btn-danger btn-sm" onclick="removeUser(\'' + safeName.replace(/'/g, "\\'") + '\')">Remove</button></td>';
      tbody.appendChild(tr);
    });
  } catch (e) {
    tbody.innerHTML = '<tr><td colspan="3" style="color:var(--danger);text-align:center">Connection error</td></tr>';
  }
}

// ── SCREEN NAV ──
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// ── ASSESSMENT NAV ──
function assessNav(dir) {
  const newStep = currentStep + dir;
  if (newStep < 0) return;
  if (newStep > 4) { computeResult(); return; }
  document.getElementById('step' + currentStep).style.display = 'none';
  currentStep = newStep;
  document.getElementById('step' + currentStep).style.display = 'block';
  document.getElementById('prevBtn').style.visibility = currentStep === 0 ? 'hidden' : 'visible';
  document.getElementById('nextBtn').textContent = currentStep === 4 ? 'Finalize Assessment' : 'Next \u2192';
  document.getElementById('progressFill').style.width = ((currentStep + 1) / totalSteps * 100) + '%';
  document.getElementById('assessContainer').scrollTop = 0;
}

// ── YES/NO TOGGLE ──
function setYN(key, val, el) {
  answers[key] = val;
  const grp = el.parentElement;
  grp.querySelectorAll('.yn-btn').forEach(b => { b.classList.remove('sel-yes','sel-no'); });
  el.classList.add(val ? 'sel-yes' : 'sel-no');
  handleConditionals(key, val);
}
function handleConditionals(key, val) {
  const show = (id, v) => { document.getElementById(id).classList.toggle('hidden', !v); };
  if (key === 'q1_2') { show('q1_2d_block', val); if (!val) answers.q1_2d = false; }
  if (key === 'q2_1') {
    show('q2_2_block', val); show('q2_3_block', val); show('q2_4_block', val); show('q2_5_block', val);
    if (val) buildSeverityInputs();
    else { answers.q2_4 = false; answers.q2_4_1 = false; answers.q2_4_2 = false; answers.q2_4_3 = false; answers.q2_5 = false;
      ['q2_4_1_block','q2_4_2_block','q2_4_3_block'].forEach(id => document.getElementById(id).classList.add('hidden')); }
  }
  if (key === 'q2_4') { show('q2_4_1_block', val); if (!val) { answers.q2_4_1 = false; answers.q2_4_2 = false; answers.q2_4_3 = false;
    ['q2_4_2_block','q2_4_3_block'].forEach(id => document.getElementById(id).classList.add('hidden')); } }
  if (key === 'q2_4_1') { show('q2_4_2_block', val); if (!val) { answers.q2_4_2 = false; answers.q2_4_3 = false; document.getElementById('q2_4_3_block').classList.add('hidden'); } }
  if (key === 'q2_4_2') { show('q2_4_3_block', val); if (!val) answers.q2_4_3 = false; }
  if (key === 'q3_1') { show('q3_1_1_block', val); if (!val) answers.q3_1_1 = undefined; }
  if (key === 'q4_1') { show('q4_1_1_block', val); if (!val) answers.q4_1_1 = false; }
}

// ── SEVERITY SLIDERS ──
function buildSeverityInputs() {
  const n = Math.max(1, Math.min(50, parseInt(document.getElementById('q2_convictions').value) || 1));
  const c = document.getElementById('severityContainer');
  c.innerHTML = '';
  for (let i = 0; i < n; i++) {
    const d = document.createElement('div');
    d.style.cssText = 'display:flex;align-items:center;gap:12px;margin-bottom:8px;padding:8px 12px;background:var(--bg-secondary);border-radius:8px';
    d.innerHTML = `<span style="font-size:13px;font-weight:600;color:var(--red);min-width:80px">Offence ${i+1}</span>
      <input type="range" min="0" max="1" step="0.1" value="0.5" oninput="this.nextElementSibling.textContent=this.value" style="flex:1">
      <span class="severity-val">0.5</span>`;
    c.appendChild(d);
  }
}

// ── SCORING ──
function computeResult() {
  let score = 0;
  const bd = {};

  let s1 = 0;
  if (answers.q1_1) s1 += 1;
  if (answers.q1_2) { s1 += 1; if (answers.q1_2d) s1 += 1; }
  if (answers.q1_slur) s1 += 2;
  bd['Section 1: Conduct'] = s1; score += s1;

  let s2 = 0;
  if (answers.q2_1) {
    const sliders = document.querySelectorAll('#severityContainer input[type=range]');
    sliders.forEach(s => { s2 += parseFloat(s.value); });
    if (answers.q2_4) { s2 += 2; if (answers.q2_4_1) { s2 += 0.5; if (answers.q2_4_2) { s2 += 1; if (answers.q2_4_3) s2 += 2.5; } } }
    if (answers.q2_5) s2 += 1.5;
  }
  bd['Section 2: Prior Offences'] = s2; score += s2;

  let s3 = 0;
  if (answers.q3_1) { s3 += 1; if (answers.q3_1_1 === true) s3 -= 1; else if (answers.q3_1_1 === false) s3 += 1.5; }
  bd['Section 3: Demeanour'] = s3; score += s3;

  let s4 = 0;
  if (answers.q4_1) { s4 -= 1; if (answers.q4_1_1) s4 += 1; }
  if (answers.q4_2) s4 -= 1;
  if (answers.q4_3) s4 -= 3;
  bd['Section 4: Mediating Factors'] = s4; score += s4;

  score = Math.round(score * 10) / 10;
  let level, desc, cls;
  if (score <= 5) { level = 1; desc = 'No Risk Present'; cls = '1'; }
  else if (score <= 10) { level = 2; desc = 'Potential Risk'; cls = '2'; }
  else if (score <= 15) { level = 3; desc = 'Risk to the Community'; cls = '3'; }
  else if (score <= 20) { level = 4; desc = 'Substantial Risk'; cls = '4'; }
  else { level = 5; desc = 'Danger to the Community'; cls = '5'; }

  showScreen('resultScreen');
  animateResult(score, level, desc, cls, bd);
}

function animateResult(score, level, desc, cls, bd) {
  const rc = document.getElementById('resultContent');
  const panel = document.getElementById('resultPanel');
  rc.innerHTML = `<div class="text-center">
    <p style="font-size:13px;font-weight:500;color:var(--text-tertiary);text-transform:uppercase;letter-spacing:.1em" id="analysisText"></p>
    <div id="scoreReveal" style="opacity:0;margin-top:20px">
      <p class="caption">ARLA Score</p>
      <div class="result-score" id="scoreNum" style="margin-top:4px">0</div>
    </div>
    <div id="levelReveal" style="opacity:0;margin-top:24px">
      <div class="result-level-num risk-${cls}" id="levelNum"></div>
      <div class="result-level-desc" id="levelDesc"></div>
    </div></div>
    <div id="breakdownReveal" style="opacity:0">
      <div class="result-breakdown">
        <div class="caption mb-8">Score Breakdown</div>
        <div class="rb-row"><span>Subject</span><span>${document.getElementById('suspectName').value || 'N/A'}</span></div>
        <div class="rb-row"><span>Jurisdiction</span><span>${document.getElementById('jurisdiction').value || 'N/A'}</span></div>
        <div class="rb-row"><span>Period</span><span>${document.getElementById('assessPeriod').value || '7'} days</span></div>
        <div class="rb-row"><span>Investigator</span><span>${currentUser}</span></div>
        <div style="height:8px"></div>
        ${Object.entries(bd).map(([k,v]) => `<div class="rb-row"><span>${k}</span><span>${v >= 0 ? '+' : ''}${v}</span></div>`).join('')}
        <div style="height:1px;background:var(--border-light);margin:8px 0"></div>
        <div class="rb-row" style="border:none"><span style="font-weight:700;color:var(--text)">Total ARLA Score</span><span style="font-size:18px;font-weight:700">${score}</span></div>
      </div>
    </div>`;

  let i = 0;
  const txt = 'Analysis Complete';
  const typeEl = document.getElementById('analysisText');
  const typeInterval = setInterval(() => { typeEl.textContent = txt.slice(0, ++i); if (i >= txt.length) clearInterval(typeInterval); }, 40);

  setTimeout(() => {
    const scoreEl = document.getElementById('scoreNum');
    const reveal1 = document.getElementById('scoreReveal');
    reveal1.style.transition = 'opacity .5s'; reveal1.style.opacity = '1';
    let cur = -2; const target = score;
    const step = target > 0 ? 0.1 : -0.1;
    const counter = setInterval(() => {
      cur = Math.round((cur + step) * 10) / 10;
      scoreEl.textContent = cur.toFixed(1);
      if ((step > 0 && cur >= target) || (step < 0 && cur <= target) || (target === 0 && cur >= 0)) { scoreEl.textContent = target.toFixed(1); clearInterval(counter); }
    }, 30);
  }, 1000);

  setTimeout(() => {
    const reveal2 = document.getElementById('levelReveal');
    reveal2.style.transition = 'opacity .6s'; reveal2.style.opacity = '1';
    document.getElementById('levelNum').textContent = 'Level ' + level;
    document.getElementById('levelDesc').textContent = desc;
  }, 2000);

  setTimeout(() => {
    const reveal3 = document.getElementById('breakdownReveal');
    reveal3.style.transition = 'opacity .6s'; reveal3.style.opacity = '1';
  }, 2800);
}

// ── UTILITIES ──
function newAssessment() { resetAssessment(); showScreen('assessScreen'); }
function resetAssessment() {
  currentStep = 0; answers = {};
  for (let i = 0; i <= 4; i++) { document.getElementById('step' + i).style.display = i === 0 ? 'block' : 'none'; }
  document.getElementById('progressFill').style.width = '0%';
  document.getElementById('prevBtn').style.visibility = 'hidden';
  document.getElementById('nextBtn').textContent = 'Next \u2192';
  document.querySelectorAll('.yn-btn').forEach(b => b.classList.remove('sel-yes','sel-no'));
  ['q1_2d_block','q2_2_block','q2_3_block','q2_4_block','q2_4_1_block','q2_4_2_block','q2_4_3_block','q2_5_block','q3_1_1_block','q4_1_1_block'].forEach(id => document.getElementById(id).classList.add('hidden'));
  document.getElementById('suspectName').value = '';
  document.getElementById('assessPeriod').value = '7';
  document.getElementById('jurisdiction').value = '';
  document.getElementById('investigator').value = currentUser || '';
  document.getElementById('severityContainer').innerHTML = '';
  document.getElementById('q2_convictions').value = '1';
}
function printResult() {
  const content = document.getElementById('resultPanel').innerHTML;
  const w = window.open('', '_blank');
  w.document.write(`<!DOCTYPE html><html><head><title>Apollo Assessment Report</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>*{margin:0;padding:0;box-sizing:border-box}body{background:#fff;color:#1d1d1f;font-family:'Inter',system-ui,sans-serif;padding:40px;font-size:14px;-webkit-font-smoothing:antialiased}
    .card{max-width:600px;margin:0 auto}
    .logo{width:64px;height:64px;margin:0 auto 16px}.logo svg{width:100%;height:100%}
    .result-score{font-size:56px;font-weight:700;color:#1d1d1f}.result-level-num{font-size:72px;font-weight:800}
    .result-level-desc{font-size:17px;font-weight:600;letter-spacing:.02em;text-transform:uppercase;margin-top:8px;color:#6e6e73}
    .risk-1{color:#43a047}.risk-2{color:#f9a825}.risk-3{color:#ef6c00}.risk-4{color:#e53935}.risk-5{color:#d32f2f}
    .result-breakdown{text-align:left;margin-top:24px;padding:20px;border:1px solid #e8e8ed;border-radius:12px;font-size:14px}
    .rb-row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #e8e8ed}
    .rb-row:last-child{border-bottom:none}
    .rb-row span:first-child{color:#6e6e73}.rb-row span:last-child{font-weight:600}
    .caption{font-size:12px;color:#86868b;font-weight:500;text-transform:uppercase;letter-spacing:.06em}
    .text-center{text-align:center}.btn{display:none}.mb-8{margin-bottom:8px}</style></head><body>${content}
    <p style="text-align:center;margin-top:32px;font-size:11px;color:#86868b">Arrephoros Technologies PLC — Confidential</p></body></html>`);
  w.document.close(); w.focus(); setTimeout(() => w.print(), 500);
}

// ── BOOT ──
window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
