<!--
  ╔══════════════════════════════════════════════════════════════╗
  ║  APOLLO RISK ASSESSMENT FRAMEWORK — Arrephoros Technologies  ║
  ║  Version One: Corvus (Server-Side Auth)                      ║
  ╠══════════════════════════════════════════════════════════════╣
  ║                                                              ║
  ║  SETUP:                                                      ║
  ║  1. Create a Google Sheet named "Apollo"                     ║
  ║  2. Extensions → Apps Script → paste Apollo-Backend.gs       ║
  ║  3. Deploy → New Deployment → Web App                        ║
  ║     Execute as: Me, Access: Anyone                           ║
  ║  4. Copy the deployment URL into API_URL below               ║
  ║  5. Host this file (GitHub Pages, etc.) and embed            ║
  ║                                                              ║
  ║  DEFAULT ADMIN (auto-seeded on first server request):        ║
  ║  Username: SYSADMIN   Password: arrephoros                   ║
  ║                                                              ║
  ╚══════════════════════════════════════════════════════════════╝
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apollo — Risk Assessment Framework</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#ffffff;--bg-secondary:#f5f5f7;--bg-tertiary:#fafafa;
  --card:#ffffff;--card-hover:#fafafa;
  --red:#e53935;--red-light:#ffebee;--red-dark:#c62828;
  --green:#43a047;--green-light:#e8f5e9;
  --amber:#f9a825;--amber-light:#fff8e1;
  --orange:#ef6c00;--orange-light:#fff3e0;
  --danger:#d32f2f;--danger-light:#ffebee;
  --text:#1d1d1f;--text-secondary:#6e6e73;--text-tertiary:#86868b;
  --border:#d2d2d7;--border-light:#e8e8ed;
  --font:'Inter',system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
  --radius:12px;--radius-sm:8px;--radius-lg:16px;
  --shadow:0 1px 3px rgba(0,0,0,.06),0 1px 2px rgba(0,0,0,.04);
  --shadow-md:0 4px 12px rgba(0,0,0,.08),0 1px 3px rgba(0,0,0,.06);
  --shadow-lg:0 12px 40px rgba(0,0,0,.1),0 4px 12px rgba(0,0,0,.06);
}
html,body{height:100%;overflow:hidden;background:var(--bg-secondary);color:var(--text);font-family:var(--font);font-size:15px;line-height:1.6;-webkit-font-smoothing:antialiased}

/* ── SCREENS ── */
.screen{position:fixed;inset:0;z-index:10;display:none;flex-direction:column;align-items:center;justify-content:center;padding:24px;overflow-y:auto}
.screen.active{display:flex}

/* ── CARD ── */
.card{background:var(--card);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);padding:40px;max-width:480px;width:100%}
.card-wide{max-width:640px}

/* ── LOGO ── */
.logo{width:200px;margin:0 auto 20px}
.logo svg{width:100%;height:auto}
.logo-icon{width:40px;height:40px}
.logo-icon svg{width:100%;height:100%}

/* ── TYPOGRAPHY ── */
h1{font-size:28px;font-weight:700;letter-spacing:-.02em;color:var(--text)}
h2{font-size:20px;font-weight:600;letter-spacing:-.01em;color:var(--text)}
h3{font-size:15px;font-weight:600;color:var(--text)}
.subtitle{font-size:14px;color:var(--text-secondary);font-weight:400;margin-top:4px}
.caption{font-size:12px;color:var(--text-tertiary);font-weight:500;text-transform:uppercase;letter-spacing:.06em}
.version-tag{display:inline-block;font-size:11px;font-weight:600;color:var(--text-tertiary);background:var(--bg-secondary);border-radius:6px;padding:2px 8px;letter-spacing:.04em;text-transform:uppercase;margin-top:8px}

/* ── FORM ── */
.field{margin-bottom:16px}
.field label{display:block;font-size:13px;font-weight:500;color:var(--text-secondary);margin-bottom:6px}
.field input,.field select,.field textarea{width:100%;background:var(--bg-secondary);border:1px solid var(--border-light);color:var(--text);padding:11px 14px;font-family:var(--font);font-size:15px;border-radius:var(--radius-sm);outline:none;transition:border-color .2s,box-shadow .2s}
.field input:focus,.field select:focus{border-color:var(--red);box-shadow:0 0 0 3px rgba(229,57,53,.12)}
.field input::placeholder{color:var(--text-tertiary)}

/* ── BUTTONS ── */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:11px 24px;font-family:var(--font);font-size:14px;font-weight:600;border:none;border-radius:var(--radius-sm);cursor:pointer;transition:all .2s;gap:6px}
.btn-primary{background:var(--red);color:#fff}
.btn-primary:hover{background:var(--red-dark);box-shadow:var(--shadow-md)}
.btn-primary:disabled{opacity:.5;cursor:not-allowed}
.btn-secondary{background:var(--bg-secondary);color:var(--text);border:1px solid var(--border)}
.btn-secondary:hover{background:var(--border-light)}
.btn-danger{background:var(--danger-light);color:var(--danger);border:1px solid transparent}
.btn-danger:hover{background:var(--danger);color:#fff}
.btn-sm{padding:7px 14px;font-size:13px;border-radius:6px}
.btn-full{width:100%}
.btn-ghost{background:transparent;color:var(--text-secondary);padding:7px 12px}
.btn-ghost:hover{background:var(--bg-secondary);color:var(--text)}

/* ── YES/NO TOGGLE ── */
.yn-group{display:flex;gap:8px;margin-top:8px}
.yn-btn{flex:1;padding:10px;text-align:center;border:1px solid var(--border-light);color:var(--text-secondary);font-family:var(--font);font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;border-radius:var(--radius-sm);background:var(--bg-tertiary)}
.yn-btn:hover{border-color:var(--border);background:var(--bg-secondary)}
.yn-btn.sel-yes{border-color:var(--red);color:var(--red);background:var(--red-light)}
.yn-btn.sel-no{border-color:var(--green);color:var(--green);background:var(--green-light)}

/* ── QUESTION BLOCK ── */
.q-block{padding:16px;border-radius:var(--radius-sm);background:var(--bg-tertiary);margin-bottom:12px;transition:all .3s}
.q-block.hidden{display:none}
.q-block .q-id{font-size:11px;font-weight:600;color:var(--red);text-transform:uppercase;letter-spacing:.06em;margin-bottom:4px}
.q-block .q-text{font-size:14px;color:var(--text);line-height:1.5}
.q-block .q-note{font-size:13px;color:var(--text-tertiary);margin-top:6px;line-height:1.5}

/* ── SLIDER ── */
input[type=range]{-webkit-appearance:none;width:100%;height:6px;background:var(--border-light);outline:none;border-radius:3px;margin:8px 0}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:20px;height:20px;background:var(--red);border-radius:50%;cursor:pointer;box-shadow:var(--shadow)}
.severity-val{font-weight:600;color:var(--red);font-size:14px;text-align:right}

/* ── PROGRESS BAR ── */
.progress-bar{width:100%;height:4px;background:var(--border-light);border-radius:2px;margin-bottom:24px;overflow:hidden}
.progress-bar .fill{height:100%;background:var(--red);transition:width .4s ease;border-radius:2px}

/* ── TABLE ── */
.user-table{width:100%;border-collapse:collapse;margin:12px 0}
.user-table th,.user-table td{padding:10px 14px;text-align:left;border-bottom:1px solid var(--border-light);font-size:14px}
.user-table th{color:var(--text-tertiary);font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.05em}
.user-table tr:hover td{background:var(--bg-tertiary)}

/* ── BADGE ── */
.badge{display:inline-block;padding:3px 10px;font-size:12px;font-weight:600;border-radius:20px}
.badge-active{background:var(--green-light);color:var(--green)}

/* ── RESULTS ── */
.result-box{text-align:center;padding:40px 24px}
.result-score{font-size:56px;font-weight:700;color:var(--text);letter-spacing:-.03em}
.result-level-num{font-size:72px;font-weight:800;line-height:1;letter-spacing:-.03em}
.result-level-desc{font-size:17px;font-weight:600;letter-spacing:.02em;text-transform:uppercase;margin-top:8px;color:var(--text-secondary)}
.result-breakdown{text-align:left;margin-top:28px;padding:20px;border:1px solid var(--border-light);border-radius:var(--radius);font-size:14px}
.result-breakdown .rb-row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid var(--border-light)}
.result-breakdown .rb-row:last-child{border-bottom:none}
.result-breakdown .rb-row span:first-child{color:var(--text-secondary)}
.result-breakdown .rb-row span:last-child{font-weight:600;color:var(--text)}

/* ── RISK COLORS ── */
.risk-1{color:var(--green)}.risk-2{color:var(--amber)}.risk-3{color:var(--orange)}.risk-4{color:#e53935}.risk-5{color:var(--danger)}
.risk-border-1{border-color:var(--green)}.risk-border-2{border-color:var(--amber)}.risk-border-3{border-color:var(--orange)}
.risk-border-4{border-color:#e53935}.risk-border-5{border-color:var(--danger)}

/* ── LOADING ── */
#loadingOverlay{position:fixed;inset:0;z-index:10000;background:var(--bg);display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity .5s}
#loadingOverlay.fade-out{opacity:0;pointer-events:none}
.loader-ring{width:40px;height:40px;border:3px solid var(--border-light);border-top-color:var(--red);border-radius:50%;animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* ── SCROLLBAR ── */
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}::-webkit-scrollbar-thumb:hover{background:var(--text-tertiary)}

/* ── SECTION DIVIDER ── */
.divider{height:1px;background:var(--border-light);margin:20px 0}

/* ── HELPERS ── */
.mt-4{margin-top:4px}.mt-8{margin-top:8px}.mt-12{margin-top:12px}.mt-16{margin-top:16px}.mt-20{margin-top:20px}.mt-24{margin-top:24px}
.mb-4{margin-bottom:4px}.mb-8{margin-bottom:8px}.mb-12{margin-bottom:12px}.mb-16{margin-bottom:16px}
.text-center{text-align:center}
.text-red{color:var(--red)}.text-secondary{color:var(--text-secondary)}
.flex-row{display:flex;gap:8px;align-items:center}
.error-msg{color:var(--danger);font-size:13px;font-weight:500;min-height:20px;margin-top:8px}
.assess-container{max-height:calc(100vh - 160px);overflow-y:auto;padding-right:4px}

/* ── ANIMATE ── */
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.animate-in{animation:fadeUp .4s ease forwards}

/* ── PANEL SECTION ── */
.panel-section{padding:20px;border:1px solid var(--border-light);border-radius:var(--radius);margin-bottom:16px}

/* ── COMPANY WATERMARK ── */
.company-watermark{position:fixed;bottom:16px;right:20px;z-index:9998;opacity:.3;pointer-events:none}
.company-watermark img{height:28px;display:block}

/* ── SCORE+LEVEL ROW ── */
.score-level-row{display:flex;align-items:center;justify-content:center;gap:32px;margin-top:20px}
.score-level-row .score-col{text-align:center}
.score-level-row .level-col{text-align:center}
</style>
</head>
<body>

<!-- COMPANY WATERMARK (all pages) -->
<div class="company-watermark"><img src="arrephoros-logo.png" alt="Arrephoros Technologies"></div>

<!-- LOADING -->
<div id="loadingOverlay">
  <div class="logo-icon" style="width:56px;height:56px;margin-bottom:24px"><svg viewBox="30 0 390 394" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="#E80101" d="M318.662415,46.329861 C350.975952,67.491737 374.216797,95.626640 388.370758,131.231705 C398.967072,157.887283 402.792847,185.594864 399.831055,213.984909 C395.370728,256.738831 377.631897,293.423401 346.923859,323.595795 C332.141571,338.120239 315.737274,350.485474 296.476776,358.639771 C294.880524,359.315552 293.171204,359.724274 290.571503,360.560364 C295.458649,356.436432 299.876984,353.399139 303.453522,349.574646 C322.485718,329.222961 333.647675,304.988129 337.987640,277.568420 C340.418854,262.208252 340.112366,247.042175 333.774078,232.474167 C329.346283,222.297211 322.891357,213.515106 314.731659,204.628601 C308.419647,210.585602 302.040070,216.091507 296.261139,222.168594 C284.631592,234.398163 275.258301,248.059097 272.571930,265.202026 C270.852905,276.171967 271.698151,286.891266 275.187012,297.671783 C278.022522,306.433594 280.017273,315.713013 280.650726,324.882690 C281.539215,337.744659 280.270691,350.628815 275.871918,363.000366 C274.065613,368.080658 271.121979,369.276764 266.693909,366.306854 C260.521790,362.167206 253.824341,362.953369 248.464661,369.193420 C245.794296,372.302429 242.866608,373.543213 239.033539,373.604645 C235.869644,373.655334 232.681244,373.652222 229.551361,374.048889 C222.770264,374.908356 217.755753,373.600433 213.095581,367.419739 C206.258911,358.352356 195.548355,358.372528 186.842010,366.291077 C184.186798,368.705994 182.073654,369.274567 178.578186,368.368896 C157.726715,362.966370 139.153198,353.071014 120.933342,341.747559 C93.021454,324.400604 74.262184,299.718140 60.725784,270.623108 C46.098583,239.183472 41.764515,206.078857 46.681545,171.740692 C52.117432,133.779099 68.531815,101.248711 94.798172,73.477821 C123.023285,43.635960 157.356934,25.598032 198.068573,20.035879 C241.287415,14.131188 281.392975,23.002148 318.662415,46.329861 M310.763367,124.316849 C312.948181,122.793770 315.146851,121.290184 317.315521,119.744469 C331.609680,109.556480 335.870483,96.270729 330.199249,78.639542 C328.861145,79.312576 327.546997,79.879265 326.325775,80.602821 C317.166168,86.029861 308.068756,91.563370 298.861969,96.908699 C293.064911,100.274376 286.722504,101.638161 280.112152,100.256416 C268.405884,97.809486 256.797211,94.888962 245.075821,92.522522 C223.330276,88.132271 202.121078,88.215576 182.198776,100.093269 C179.499542,101.702545 175.428635,101.693115 172.077698,101.414116 C153.477859,99.865547 138.705322,91.045265 126.903770,76.860123 C125.792709,75.524658 124.584282,74.270203 123.421059,72.978134 C122.906746,73.112480 122.392441,73.246826 121.878128,73.381172 C121.878128,77.431305 122.350616,81.548676 121.785728,85.518425 C120.339378,95.682579 124.747345,103.379227 130.945007,110.780029 C143.795776,126.125488 160.440628,135.712357 179.080978,141.542572 C195.659592,146.727951 209.741806,154.949585 220.740311,168.433060 C222.233841,170.264023 224.343658,171.592239 226.479538,173.419678 C227.733597,171.616974 228.579880,170.420807 229.405518,169.210556 C238.001938,156.609787 248.615250,146.734848 264.039368,143.173401 C280.355499,139.405960 295.686340,133.123657 310.763367,124.316849 M152.257233,211.236725 C148.147202,207.846405 144.145645,204.307068 139.846191,201.176926 C138.847656,200.449951 136.172775,200.454834 135.385223,201.240967 C119.994370,216.604218 109.448463,234.572540 110.426384,256.930267 C112.059555,294.268555 126.122505,326.001801 156.209335,349.309540 C163.636627,355.063263 172.264160,359.272675 180.379486,364.125885 C181.236099,364.638153 182.360657,364.702423 184.359070,365.246063 C183.650345,362.667023 183.222290,360.991943 182.729462,359.336182 C180.564224,352.061584 177.734406,344.913910 176.340393,337.495697 C173.613007,322.982056 174.739685,308.521393 180.566284,294.861481 C186.553925,280.824066 186.780304,266.755249 182.229401,252.496246 C176.880325,235.736450 165.471558,223.235016 152.257233,211.236725 M241.118744,208.245575 C239.749130,209.786362 238.379517,211.327148 236.985458,212.895447 C262.901520,232.763733 290.633514,223.471542 306.416840,202.851715 C318.281067,187.351913 316.226044,157.054550 304.153473,141.622360 C302.847260,139.952652 301.232758,138.331650 299.410522,137.319443 C297.973572,136.521240 295.996857,136.694809 294.259888,136.436783 C294.181244,137.974777 293.871643,139.541946 294.061523,141.046051 C295.286072,150.744232 297.562958,160.413269 297.721161,170.120773 C298.049957,190.294220 288.133545,201.883621 268.303741,205.152786 C261.495789,206.275177 254.391632,205.515747 247.437820,205.893005 C245.498154,205.998260 243.612152,207.092804 241.118744,208.245575 M157.203583,142.704254 C157.579285,140.668564 157.954987,138.632874 158.374847,136.357986 C153.247375,135.288956 150.531830,138.003983 148.252747,141.070709 C142.620224,148.649857 140.573257,157.512756 139.446167,166.694946 C135.853882,195.960144 156.236328,213.607132 180.934296,216.106140 C191.876221,217.213287 201.551514,213.023224 210.522369,206.337082 C206.981735,201.838913 203.996735,198.795944 197.851685,199.635071 C192.030167,200.430038 185.868652,199.762115 179.985764,198.878204 C165.354172,196.679779 155.992783,187.480423 155.060028,172.704514 C154.451569,163.065933 156.298599,153.272324 157.203583,142.704254 M194.757828,156.715408 C187.345032,151.616898 180.027786,152.604660 175.774719,159.278030 C171.874695,165.397385 173.905182,173.252197 180.327469,176.890152 C185.033401,179.555862 191.749298,178.498306 195.436081,174.429794 C198.784195,170.735031 200.957657,163.616745 194.757828,156.715408 M258.894440,156.301392 C254.016190,161.726913 253.072845,166.972702 256.058044,172.074188 C259.539368,178.023514 267.119171,180.161209 272.926941,176.831635 C279.083771,173.301941 281.209137,165.510529 277.627899,159.598328 C273.714417,153.137650 266.535950,151.674973 258.894440,156.301392 M225.439148,182.025024 C222.943115,182.025085 220.439667,182.147156 217.952789,181.996307 C214.315170,181.775665 213.739273,183.163116 214.827789,186.467941 C217.266769,193.872864 219.353851,201.393204 221.640366,208.849335 C222.022400,210.095078 222.686813,211.254196 223.220734,212.453354 C223.723679,212.420837 224.226608,212.388321 224.729538,212.355804 C227.667816,202.542328 230.606079,192.728867 233.810944,182.025024 C230.617004,182.025024 228.505814,182.025024 225.439148,182.025024z"/><path fill="#FFFDFD" d="M310.465088,124.527550 C295.686340,133.123657 280.355499,139.405960 264.039368,143.173401 C248.615250,146.734848 238.001938,156.609787 229.405518,169.210556 C228.579880,170.420807 227.733597,171.616974 226.479538,173.419678 C224.343658,171.592239 222.233841,170.264023 220.740311,168.433060 C209.741806,154.949585 195.659592,146.727951 179.080978,141.542572 C160.440628,135.712357 143.795776,126.125488 130.945007,110.780029 C124.747345,103.379227 120.339378,95.682579 121.785728,85.518425 C122.350616,81.548676 121.878128,77.431305 121.878128,73.381172 C122.392441,73.246826 122.906746,73.112480 123.421059,72.978134 C124.584282,74.270203 125.792709,75.524658 126.903770,76.860123 C138.705322,91.045265 153.477859,99.865547 172.077698,101.414116 C175.428635,101.693115 179.499542,101.702545 182.198776,100.093269 C202.121078,88.215576 223.330276,88.132271 245.075821,92.522522 C256.797211,94.888962 268.405884,97.809486 280.112152,100.256416 C286.722504,101.638161 293.064911,100.274376 298.861969,96.908699 C308.068756,91.563370 317.166168,86.029861 326.325775,80.602821 C327.546997,79.879265 328.861145,79.312576 330.199249,78.639542 C335.870483,96.270729 331.609680,109.556480 317.315521,119.744469 C315.146851,121.290184 312.948181,122.793770 310.465088,124.527550z"/><path fill="#FFFEFE" d="M152.516022,211.478577 C165.471558,223.235016 176.880325,235.736450 182.229401,252.496246 C186.780304,266.755249 186.553925,280.824066 180.566284,294.861481 C174.739685,308.521393 173.613007,322.982056 176.340393,337.495697 C177.734406,344.913910 180.564224,352.061584 182.729462,359.336182 C183.222290,360.991943 183.650345,362.667023 184.359070,365.246063 C182.360657,364.702423 181.236099,364.638153 180.379486,364.125885 C172.264160,359.272675 163.636627,355.063263 156.209335,349.309540 C126.122505,326.001801 112.059555,294.268555 110.426384,256.930267 C109.448463,234.572540 119.994370,216.604218 135.385223,201.240967 C136.172775,200.454834 138.847656,200.449951 139.846191,201.176926 C144.145645,204.307068 148.147202,207.846405 152.516022,211.478577z"/><path fill="#FFFBFB" d="M241.410126,207.989532 C243.612152,207.092804 245.498154,205.998260 247.437820,205.893005 C254.391632,205.515747 261.495789,206.275177 268.303741,205.152786 C288.133545,201.883621 298.049957,190.294220 297.721161,170.120773 C297.562958,160.413269 295.286072,150.744232 294.061523,141.046051 C293.871643,139.541946 294.181244,137.974777 294.259888,136.436768 C295.996857,136.694809 297.973572,136.521240 299.410522,137.319443 C301.232758,138.331650 302.847260,139.952652 304.153473,141.622360 C316.226044,157.054550 318.281067,187.351913 306.416840,202.851715 C290.633514,223.471542 262.901520,232.763733 236.985458,212.895447 C238.379517,211.327148 239.749130,209.786362 241.410126,207.989532z"/><path fill="#FFFBFB" d="M157.124634,143.126221 C156.298599,153.272324 154.451569,163.065933 155.060028,172.704514 C155.992783,187.480423 165.354172,196.679779 179.985764,198.878204 C185.868652,199.762115 192.030167,200.430038 197.851685,199.635071 C203.996735,198.795944 206.981735,201.838913 210.522369,206.337082 C201.551514,213.023224 191.876221,217.213287 180.934296,216.106140 C156.236328,213.607132 135.853882,195.960144 139.446167,166.694946 C140.573257,157.512756 142.620224,148.649857 148.252747,141.070709 C150.531830,138.003983 153.247375,135.288956 158.374847,136.357986 C157.954987,138.632874 157.579285,140.668564 157.124634,143.126221z"/><path fill="#FFFAFA" d="M195.032806,156.968185 C200.957657,163.616745 198.784195,170.735031 195.436081,174.429794 C191.749298,178.498306 185.033401,179.555862 180.327469,176.890152 C173.905182,173.252197 171.874695,165.397385 175.774719,159.278030 C180.027786,152.604660 187.345032,151.616898 195.032806,156.968185z"/><path fill="#FFFBFB" d="M259.214050,156.106400 C266.535950,151.674973 273.714417,153.137650 277.627899,159.598328 C281.209137,165.510529 279.083771,173.301941 272.926941,176.831635 C267.119171,180.161209 259.539368,178.023514 256.058044,172.074188 C253.072845,166.972702 254.016190,161.726913 259.214050,156.106400z"/><path fill="#FEF7F7" d="M225.916901,182.025024 C228.505814,182.025024 230.617004,182.025024 233.810944,182.025024 C230.606079,192.728867 227.667816,202.542328 224.729538,212.355804 C224.226608,212.388321 223.723679,212.420837 223.220734,212.453354 C222.686813,211.254196 222.022400,210.095078 221.640366,208.849335 C219.353851,201.393204 217.266769,193.872864 214.827789,186.467941 C213.739273,183.163116 214.315170,181.775665 217.952789,181.996307 C220.439667,182.147156 222.943115,182.025085 225.916901,182.025024z"/></svg></div>
  <div class="loader-ring"></div>
</div>

<!-- ═══════════ LOGIN SCREEN ═══════════ -->
<div class="screen active" id="loginScreen">
  <div class="card" style="max-width:400px">
    <div class="text-center">
      <div class="logo"><svg viewBox="0 0 1268 394" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="#E80101" d="M318.662415,46.329861 C350.975952,67.491737 374.216797,95.626640 388.370758,131.231705 C398.967072,157.887283 402.792847,185.594864 399.831055,213.984909 C395.370728,256.738831 377.631897,293.423401 346.923859,323.595795 C332.141571,338.120239 315.737274,350.485474 296.476776,358.639771 C294.880524,359.315552 293.171204,359.724274 290.571503,360.560364 C295.458649,356.436432 299.876984,353.399139 303.453522,349.574646 C322.485718,329.222961 333.647675,304.988129 337.987640,277.568420 C340.418854,262.208252 340.112366,247.042175 333.774078,232.474167 C329.346283,222.297211 322.891357,213.515106 314.731659,204.628601 C308.419647,210.585602 302.040070,216.091507 296.261139,222.168594 C284.631592,234.398163 275.258301,248.059097 272.571930,265.202026 C270.852905,276.171967 271.698151,286.891266 275.187012,297.671783 C278.022522,306.433594 280.017273,315.713013 280.650726,324.882690 C281.539215,337.744659 280.270691,350.628815 275.871918,363.000366 C274.065613,368.080658 271.121979,369.276764 266.693909,366.306854 C260.521790,362.167206 253.824341,362.953369 248.464661,369.193420 C245.794296,372.302429 242.866608,373.543213 239.033539,373.604645 C235.869644,373.655334 232.681244,373.652222 229.551361,374.048889 C222.770264,374.908356 217.755753,373.600433 213.095581,367.419739 C206.258911,358.352356 195.548355,358.372528 186.842010,366.291077 C184.186798,368.705994 182.073654,369.274567 178.578186,368.368896 C157.726715,362.966370 139.153198,353.071014 120.933342,341.747559 C93.021454,324.400604 74.262184,299.718140 60.725784,270.623108 C46.098583,239.183472 41.764515,206.078857 46.681545,171.740692 C52.117432,133.779099 68.531815,101.248711 94.798172,73.477821 C123.023285,43.635960 157.356934,25.598032 198.068573,20.035879 C241.287415,14.131188 281.392975,23.002148 318.662415,46.329861 M310.763367,124.316849 C312.948181,122.793770 315.146851,121.290184 317.315521,119.744469 C331.609680,109.556480 335.870483,96.270729 330.199249,78.639542 C328.861145,79.312576 327.546997,79.879265 326.325775,80.602821 C317.166168,86.029861 308.068756,91.563370 298.861969,96.908699 C293.064911,100.274376 286.722504,101.638161 280.112152,100.256416 C268.405884,97.809486 256.797211,94.888962 245.075821,92.522522 C223.330276,88.132271 202.121078,88.215576 182.198776,100.093269 C179.499542,101.702545 175.428635,101.693115 172.077698,101.414116 C153.477859,99.865547 138.705322,91.045265 126.903770,76.860123 C125.792709,75.524658 124.584282,74.270203 123.421059,72.978134 C122.906746,73.112480 122.392441,73.246826 121.878128,73.381172 C121.878128,77.431305 122.350616,81.548676 121.785728,85.518425 C120.339378,95.682579 124.747345,103.379227 130.945007,110.780029 C143.795776,126.125488 160.440628,135.712357 179.080978,141.542572 C195.659592,146.727951 209.741806,154.949585 220.740311,168.433060 C222.233841,170.264023 224.343658,171.592239 226.479538,173.419678 C227.733597,171.616974 228.579880,170.420807 229.405518,169.210556 C238.001938,156.609787 248.615250,146.734848 264.039368,143.173401 C280.355499,139.405960 295.686340,133.123657 310.763367,124.316849 M152.257233,211.236725 C148.147202,207.846405 144.145645,204.307068 139.846191,201.176926 C138.847656,200.449951 136.172775,200.454834 135.385223,201.240967 C119.994370,216.604218 109.448463,234.572540 110.426384,256.930267 C112.059555,294.268555 126.122505,326.001801 156.209335,349.309540 C163.636627,355.063263 172.264160,359.272675 180.379486,364.125885 C181.236099,364.638153 182.360657,364.702423 184.359070,365.246063 C183.650345,362.667023 183.222290,360.991943 182.729462,359.336182 C180.564224,352.061584 177.734406,344.913910 176.340393,337.495697 C173.613007,322.982056 174.739685,308.521393 180.566284,294.861481 C186.553925,280.824066 186.780304,266.755249 182.229401,252.496246 C176.880325,235.736450 165.471558,223.235016 152.257233,211.236725 M241.118744,208.245575 C239.749130,209.786362 238.379517,211.327148 236.985458,212.895447 C262.901520,232.763733 290.633514,223.471542 306.416840,202.851715 C318.281067,187.351913 316.226044,157.054550 304.153473,141.622360 C302.847260,139.952652 301.232758,138.331650 299.410522,137.319443 C297.973572,136.521240 295.996857,136.694809 294.259888,136.436783 C294.181244,137.974777 293.871643,139.541946 294.061523,141.046051 C295.286072,150.744232 297.562958,160.413269 297.721161,170.120773 C298.049957,190.294220 288.133545,201.883621 268.303741,205.152786 C261.495789,206.275177 254.391632,205.515747 247.437820,205.893005 C245.498154,205.998260 243.612152,207.092804 241.118744,208.245575 M157.203583,142.704254 C157.579285,140.668564 157.954987,138.632874 158.374847,136.357986 C153.247375,135.288956 150.531830,138.003983 148.252747,141.070709 C142.620224,148.649857 140.573257,157.512756 139.446167,166.694946 C135.853882,195.960144 156.236328,213.607132 180.934296,216.106140 C191.876221,217.213287 201.551514,213.023224 210.522369,206.337082 C206.981735,201.838913 203.996735,198.795944 197.851685,199.635071 C192.030167,200.430038 185.868652,199.762115 179.985764,198.878204 C165.354172,196.679779 155.992783,187.480423 155.060028,172.704514 C154.451569,163.065933 156.298599,153.272324 157.203583,142.704254 M194.757828,156.715408 C187.345032,151.616898 180.027786,152.604660 175.774719,159.278030 C171.874695,165.397385 173.905182,173.252197 180.327469,176.890152 C185.033401,179.555862 191.749298,178.498306 195.436081,174.429794 C198.784195,170.735031 200.957657,163.616745 194.757828,156.715408 M258.894440,156.301392 C254.016190,161.726913 253.072845,166.972702 256.058044,172.074188 C259.539368,178.023514 267.119171,180.161209 272.926941,176.831635 C279.083771,173.301941 281.209137,165.510529 277.627899,159.598328 C273.714417,153.137650 266.535950,151.674973 258.894440,156.301392 M225.439148,182.025024 C222.943115,182.025085 220.439667,182.147156 217.952789,181.996307 C214.315170,181.775665 213.739273,183.163116 214.827789,186.467941 C217.266769,193.872864 219.353851,201.393204 221.640366,208.849335 C222.022400,210.095078 222.686813,211.254196 223.220734,212.453354 C223.723679,212.420837 224.226608,212.388321 224.729538,212.355804 C227.667816,202.542328 230.606079,192.728867 233.810944,182.025024 C230.617004,182.025024 228.505814,182.025024 225.439148,182.025024z"/><path fill="#020202" d="M669.477112,169.477386 C688.932373,143.972046 727.323547,144.982361 749.711731,162.306015 C765.254272,174.332535 772.966064,190.519257 775.971375,209.425446 C776.407959,212.171936 776.776794,214.929184 777.108093,217.207260 C779.779724,209.041794 781.869385,200.277176 785.442505,192.166046 C797.782776,164.152771 819.870789,149.894135 850.186707,148.317169 C872.679688,147.147141 894.266418,150.059967 911.769897,166.013107 C926.472534,179.413498 934.531250,196.627335 937.478882,216.065628 C941.134583,240.173355 937.712463,263.136536 924.563354,284.174377 C912.605286,303.306793 895.031555,313.272705 872.975586,316.014191 C855.365662,318.203064 837.976257,317.448425 821.477295,310.413574 C798.285645,300.525177 786.443542,281.308533 779.985840,258.022827 C778.989380,254.429459 778.406799,250.721283 777.566040,246.751114 C775.355530,255.447464 773.794250,263.931122 771.041687,272.008759 C759.744202,305.161804 727.911865,322.419830 694.077515,313.906342 C684.598145,311.521179 676.911133,306.085358 670.834045,298.419464 C669.402893,296.614136 668.023254,294.767975 665.533325,293.012787 C665.533325,306.491516 665.533325,319.970245 665.533325,333.448975 C665.533325,346.830292 665.533325,360.211609 665.533325,373.768921 C652.706116,373.768921 639.412109,373.768921 625.332947,373.768921 C625.332947,300.363556 625.332947,227.019318 625.332947,153.373444 C637.790466,153.373444 650.676514,153.373444 664.005188,153.373444 C664.005188,160.598343 664.005188,167.818893 664.005188,175.039459 C664.313965,175.179581 664.622742,175.319717 664.931519,175.459854 C666.370605,173.556381 667.809753,171.652893 669.477112,169.477386 M821.014465,246.374725 C822.324341,251.160614 823.161194,256.141205 825.035461,260.694763 C830.028198,272.824951 838.988037,280.391083 852.274963,281.826996 C867.081848,283.427216 880.230774,279.790161 887.570801,265.834625 C898.434753,245.178848 898.104858,223.527557 889.220154,202.352173 C883.656799,189.092667 872.164917,183.201920 858.056030,183.145798 C844.490173,183.091827 833.437866,188.286362 826.866516,200.795837 C819.438171,214.936813 819.085510,230.092392 821.014465,246.374725 M729.156677,205.407227 C721.824890,190.343140 712.511292,184.960297 695.634949,186.033249 C682.252075,186.884094 672.101929,195.318680 667.681213,209.925491 C666.058960,215.285812 664.990845,220.922821 664.533447,226.504379 C663.537231,238.661942 663.780029,250.822098 669.011230,262.199951 C674.511169,274.162323 684.071655,280.393585 697.193176,281.078125 C710.714600,281.783508 721.420166,276.757355 727.575684,264.450378 C737.102905,245.402344 737.065308,225.799500 729.156677,205.407227z"/><path fill="#020202" d="M556.157349,123.746918 C578.333374,186.346588 600.398499,248.570374 622.637512,311.284393 C606.178650,311.284393 590.429749,311.284393 574.134094,311.284393 C570.526428,299.901367 566.812988,288.232819 563.131897,276.554108 C560.288879,267.534424 560.306885,267.528717 550.920410,267.528717 C529.426086,267.528717 507.931000,267.618378 486.438110,267.443390 C482.717957,267.413086 480.986938,268.327850 479.803802,272.115784 C475.697968,285.261108 471.092377,298.250366 466.640991,311.405182 C451.159668,311.405182 435.853210,311.405182 419.912384,311.405182 C421.283569,307.555054 422.593750,303.869629 423.908386,300.185760 C447.513275,234.041946 471.149567,167.909256 494.633881,101.722649 C495.820496,98.378441 497.136414,97.080536 500.822021,97.145988 C514.647339,97.391525 528.481384,97.362534 542.308044,97.158913 C545.648315,97.109726 547.259827,97.931816 548.296387,101.284088 C550.599670,108.733002 553.430603,116.018768 556.157349,123.746918 M504.809448,196.269379 C501.095795,207.549057 497.382141,218.828735 493.607178,230.294724 C511.957397,230.294724 529.624817,230.294724 547.757019,230.294724 C538.939148,202.504684 530.271240,175.187103 521.561707,147.738541 C520.908020,148.130463 520.684570,148.183807 520.646423,148.298706 C515.421814,164.029190 510.210663,179.764191 504.809448,196.269379z"/><path fill="#020202" d="M1193.187744,301.229095 C1173.825806,315.241150 1152.223022,317.458374 1129.643677,315.226562 C1107.989014,313.086151 1090.172974,304.189819 1077.631714,285.882568 C1069.200073,273.574310 1064.138306,259.997345 1062.481689,245.209457 C1059.868774,221.883987 1063.384644,199.793030 1076.254272,179.693390 C1086.325562,163.964096 1100.299805,153.844147 1118.639648,149.739365 C1135.865845,145.883804 1153.023193,145.977570 1170.015015,150.623215 C1194.431763,157.298859 1209.505127,174.263382 1217.367310,197.292908 C1228.433105,229.706070 1225.589478,260.880219 1204.866943,289.191498 C1201.664795,293.566284 1197.290161,297.082947 1193.187744,301.229095 M1162.545166,187.881973 C1148.931396,178.405426 1121.080811,178.867706 1111.148926,200.697189 C1101.669800,221.531403 1101.698242,243.032852 1111.832031,263.756653 C1118.215454,276.810486 1129.936890,281.513550 1144.061646,281.120331 C1158.289551,280.724213 1168.604248,274.016418 1174.348145,261.258789 C1180.974976,246.540695 1181.199341,230.958466 1178.440674,215.257797 C1176.542358,204.453476 1172.265991,194.976837 1162.545166,187.881973z"/><path fill="#040404" d="M1010.251404,185.999863 C1010.251404,156.347626 1010.251404,127.195396 1010.251404,97.140961 C1024.101562,97.140961 1037.717041,97.140961 1051.604248,97.140961 C1051.604248,167.815491 1051.604248,238.898193 1051.604248,310.786560 C1038.016479,310.786560 1024.503296,310.786560 1010.251404,310.786560 C1010.251404,269.660614 1010.251404,228.080246 1010.251404,185.999863z"/><path fill="#040404" d="M948.470337,192.999741 C948.511292,161.176758 948.551025,129.853775 948.611145,98.530838 C948.611694,98.239273 948.884399,97.948242 949.133728,97.449646 C962.465210,97.449646 975.892883,97.449646 989.641357,97.449646 C989.641357,168.758636 989.641357,239.948822 989.641357,311.365723 C976.048889,311.365723 962.612793,311.365723 948.470337,311.365723 C948.470337,272.006348 948.470337,232.753052 948.470337,192.999741z"/><path fill="#FFFDFD" d="M310.465088,124.527550 C295.686340,133.123657 280.355499,139.405960 264.039368,143.173401 C248.615250,146.734848 238.001938,156.609787 229.405518,169.210556 C228.579880,170.420807 227.733597,171.616974 226.479538,173.419678 C224.343658,171.592239 222.233841,170.264023 220.740311,168.433060 C209.741806,154.949585 195.659592,146.727951 179.080978,141.542572 C160.440628,135.712357 143.795776,126.125488 130.945007,110.780029 C124.747345,103.379227 120.339378,95.682579 121.785728,85.518425 C122.350616,81.548676 121.878128,77.431305 121.878128,73.381172 C122.392441,73.246826 122.906746,73.112480 123.421059,72.978134 C124.584282,74.270203 125.792709,75.524658 126.903770,76.860123 C138.705322,91.045265 153.477859,99.865547 172.077698,101.414116 C175.428635,101.693115 179.499542,101.702545 182.198776,100.093269 C202.121078,88.215576 223.330276,88.132271 245.075821,92.522522 C256.797211,94.888962 268.405884,97.809486 280.112152,100.256416 C286.722504,101.638161 293.064911,100.274376 298.861969,96.908699 C308.068756,91.563370 317.166168,86.029861 326.325775,80.602821 C327.546997,79.879265 328.861145,79.312576 330.199249,78.639542 C335.870483,96.270729 331.609680,109.556480 317.315521,119.744469 C315.146851,121.290184 312.948181,122.793770 310.465088,124.527550z"/><path fill="#FFFEFE" d="M152.516022,211.478577 C165.471558,223.235016 176.880325,235.736450 182.229401,252.496246 C186.780304,266.755249 186.553925,280.824066 180.566284,294.861481 C174.739685,308.521393 173.613007,322.982056 176.340393,337.495697 C177.734406,344.913910 180.564224,352.061584 182.729462,359.336182 C183.222290,360.991943 183.650345,362.667023 184.359070,365.246063 C182.360657,364.702423 181.236099,364.638153 180.379486,364.125885 C172.264160,359.272675 163.636627,355.063263 156.209335,349.309540 C126.122505,326.001801 112.059555,294.268555 110.426384,256.930267 C109.448463,234.572540 119.994370,216.604218 135.385223,201.240967 C136.172775,200.454834 138.847656,200.449951 139.846191,201.176926 C144.145645,204.307068 148.147202,207.846405 152.516022,211.478577z"/><path fill="#FFFBFB" d="M241.410126,207.989532 C243.612152,207.092804 245.498154,205.998260 247.437820,205.893005 C254.391632,205.515747 261.495789,206.275177 268.303741,205.152786 C288.133545,201.883621 298.049957,190.294220 297.721161,170.120773 C297.562958,160.413269 295.286072,150.744232 294.061523,141.046051 C293.871643,139.541946 294.181244,137.974777 294.259888,136.436768 C295.996857,136.694809 297.973572,136.521240 299.410522,137.319443 C301.232758,138.331650 302.847260,139.952652 304.153473,141.622360 C316.226044,157.054550 318.281067,187.351913 306.416840,202.851715 C290.633514,223.471542 262.901520,232.763733 236.985458,212.895447 C238.379517,211.327148 239.749130,209.786362 241.410126,207.989532z"/><path fill="#FFFBFB" d="M157.124634,143.126221 C156.298599,153.272324 154.451569,163.065933 155.060028,172.704514 C155.992783,187.480423 165.354172,196.679779 179.985764,198.878204 C185.868652,199.762115 192.030167,200.430038 197.851685,199.635071 C203.996735,198.795944 206.981735,201.838913 210.522369,206.337082 C201.551514,213.023224 191.876221,217.213287 180.934296,216.106140 C156.236328,213.607132 135.853882,195.960144 139.446167,166.694946 C140.573257,157.512756 142.620224,148.649857 148.252747,141.070709 C150.531830,138.003983 153.247375,135.288956 158.374847,136.357986 C157.954987,138.632874 157.579285,140.668564 157.124634,143.126221z"/><path fill="#FFFAFA" d="M195.032806,156.968185 C200.957657,163.616745 198.784195,170.735031 195.436081,174.429794 C191.749298,178.498306 185.033401,179.555862 180.327469,176.890152 C173.905182,173.252197 171.874695,165.397385 175.774719,159.278030 C180.027786,152.604660 187.345032,151.616898 195.032806,156.968185z"/><path fill="#FFFBFB" d="M259.214050,156.106400 C266.535950,151.674973 273.714417,153.137650 277.627899,159.598328 C281.209137,165.510529 279.083771,173.301941 272.926941,176.831635 C267.119171,180.161209 259.539368,178.023514 256.058044,172.074188 C253.072845,166.972702 254.016190,161.726913 259.214050,156.106400z"/><path fill="#FEF7F7" d="M225.916901,182.025024 C228.505814,182.025024 230.617004,182.025024 233.810944,182.025024 C230.606079,192.728867 227.667816,202.542328 224.729538,212.355804 C224.226608,212.388321 223.723679,212.420837 223.220734,212.453354 C222.686813,211.254196 222.022400,210.095078 221.640366,208.849335 C219.353851,201.393204 217.266769,193.872864 214.827789,186.467941 C213.739273,183.163116 214.315170,181.775665 217.952789,181.996307 C220.439667,182.147156 222.943115,182.025085 225.916901,182.025024z"/><path fill="#FEFEFE" d="M820.964600,245.939178 C819.085510,230.092392 819.438171,214.936813 826.866516,200.795837 C833.437866,188.286362 844.490173,183.091827 858.056030,183.145798 C872.164917,183.201920 883.656799,189.092667 889.220154,202.352173 C898.104858,223.527557 898.434753,245.178848 887.570801,265.834625 C880.230774,279.790161 867.081848,283.427216 852.274963,281.826996 C838.988037,280.391083 830.028198,272.824951 825.035461,260.694763 C823.161194,256.141205 822.324341,251.160614 820.964600,245.939178z"/><path fill="#FDFDFD" d="M729.353516,205.732544 C737.065308,225.799500 737.102905,245.402344 727.575684,264.450378 C721.420166,276.757355 710.714600,281.783508 697.193176,281.078125 C684.071655,280.393585 674.511169,274.162323 669.011230,262.199951 C663.780029,250.822098 663.537231,238.661942 664.533447,226.504379 C664.990845,220.922821 666.058960,215.285812 667.681213,209.925491 C672.101929,195.318680 682.252075,186.884094 695.634949,186.033249 C712.511292,184.960297 721.824890,190.343140 729.353516,205.732544z"/><path fill="#FAFAFA" d="M504.904175,195.884186 C510.210663,179.764191 515.421814,164.029190 520.646423,148.298706 C520.684570,148.183807 520.908020,148.130463 521.561707,147.738541 C530.271240,175.187103 538.939148,202.504684 547.757019,230.294724 C529.624817,230.294724 511.957397,230.294724 493.607178,230.294724 C497.382141,218.828735 501.095795,207.549057 504.904175,195.884186z"/><path fill="#FEFEFE" d="M1162.870850,188.044876 C1172.265991,194.976837 1176.542358,204.453476 1178.440674,215.257797 C1181.199341,230.958466 1180.974976,246.540695 1174.348145,261.258789 C1168.604248,274.016418 1158.289551,280.724213 1144.061646,281.120331 C1129.936890,281.513550 1118.215454,276.810486 1111.832031,263.756653 C1101.698242,243.032852 1101.669800,221.531403 1111.148926,200.697189 C1121.080811,178.867706 1148.931396,178.405426 1162.870850,188.044876z"/></svg></div>
      <div class="version-tag">Corvus</div>
    </div>
    <div style="margin-top:28px">
      <div class="field"><label>Username</label><input type="text" id="loginUser" placeholder="Enter your username" autocomplete="off"></div>
      <div class="field"><label>Password</label><input type="password" id="loginPass" placeholder="Enter your password" autocomplete="off"></div>
      <div class="error-msg" id="loginErr"></div>
      <button class="btn btn-primary btn-full" onclick="doLogin()">Sign In</button>
    </div>
    <p class="text-center mt-16" style="font-size:12px;color:var(--text-tertiary)">Arrephoros Technologies PLC</p>
  </div>
</div>

<!-- ═══════════ ADMIN SCREEN ═══════════ -->
<div class="screen" id="adminScreen">
  <div class="card card-wide">
    <div class="flex-row" style="justify-content:space-between;margin-bottom:24px">
      <div class="flex-row">
        <div class="logo-icon"><svg viewBox="30 0 390 394" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="#E80101" d="M318.662415,46.329861 C350.975952,67.491737 374.216797,95.626640 388.370758,131.231705 C398.967072,157.887283 402.792847,185.594864 399.831055,213.984909 C395.370728,256.738831 377.631897,293.423401 346.923859,323.595795 C332.141571,338.120239 315.737274,350.485474 296.476776,358.639771 C294.880524,359.315552 293.171204,359.724274 290.571503,360.560364 C295.458649,356.436432 299.876984,353.399139 303.453522,349.574646 C322.485718,329.222961 333.647675,304.988129 337.987640,277.568420 C340.418854,262.208252 340.112366,247.042175 333.774078,232.474167 C329.346283,222.297211 322.891357,213.515106 314.731659,204.628601 C308.419647,210.585602 302.040070,216.091507 296.261139,222.168594 C284.631592,234.398163 275.258301,248.059097 272.571930,265.202026 C270.852905,276.171967 271.698151,286.891266 275.187012,297.671783 C278.022522,306.433594 280.017273,315.713013 280.650726,324.882690 C281.539215,337.744659 280.270691,350.628815 275.871918,363.000366 C274.065613,368.080658 271.121979,369.276764 266.693909,366.306854 C260.521790,362.167206 253.824341,362.953369 248.464661,369.193420 C245.794296,372.302429 242.866608,373.543213 239.033539,373.604645 C235.869644,373.655334 232.681244,373.652222 229.551361,374.048889 C222.770264,374.908356 217.755753,373.600433 213.095581,367.419739 C206.258911,358.352356 195.548355,358.372528 186.842010,366.291077 C184.186798,368.705994 182.073654,369.274567 178.578186,368.368896 C157.726715,362.966370 139.153198,353.071014 120.933342,341.747559 C93.021454,324.400604 74.262184,299.718140 60.725784,270.623108 C46.098583,239.183472 41.764515,206.078857 46.681545,171.740692 C52.117432,133.779099 68.531815,101.248711 94.798172,73.477821 C123.023285,43.635960 157.356934,25.598032 198.068573,20.035879 C241.287415,14.131188 281.392975,23.002148 318.662415,46.329861 M310.763367,124.316849 C312.948181,122.793770 315.146851,121.290184 317.315521,119.744469 C331.609680,109.556480 335.870483,96.270729 330.199249,78.639542 C328.861145,79.312576 327.546997,79.879265 326.325775,80.602821 C317.166168,86.029861 308.068756,91.563370 298.861969,96.908699 C293.064911,100.274376 286.722504,101.638161 280.112152,100.256416 C268.405884,97.809486 256.797211,94.888962 245.075821,92.522522 C223.330276,88.132271 202.121078,88.215576 182.198776,100.093269 C179.499542,101.702545 175.428635,101.693115 172.077698,101.414116 C153.477859,99.865547 138.705322,91.045265 126.903770,76.860123 C125.792709,75.524658 124.584282,74.270203 123.421059,72.978134 C122.906746,73.112480 122.392441,73.246826 121.878128,73.381172 C121.878128,77.431305 122.350616,81.548676 121.785728,85.518425 C120.339378,95.682579 124.747345,103.379227 130.945007,110.780029 C143.795776,126.125488 160.440628,135.712357 179.080978,141.542572 C195.659592,146.727951 209.741806,154.949585 220.740311,168.433060 C222.233841,170.264023 224.343658,171.592239 226.479538,173.419678 C227.733597,171.616974 228.579880,170.420807 229.405518,169.210556 C238.001938,156.609787 248.615250,146.734848 264.039368,143.173401 C280.355499,139.405960 295.686340,133.123657 310.763367,124.316849 M152.257233,211.236725 C148.147202,207.846405 144.145645,204.307068 139.846191,201.176926 C138.847656,200.449951 136.172775,200.454834 135.385223,201.240967 C119.994370,216.604218 109.448463,234.572540 110.426384,256.930267 C112.059555,294.268555 126.122505,326.001801 156.209335,349.309540 C163.636627,355.063263 172.264160,359.272675 180.379486,364.125885 C181.236099,364.638153 182.360657,364.702423 184.359070,365.246063 C183.650345,362.667023 183.222290,360.991943 182.729462,359.336182 C180.564224,352.061584 177.734406,344.913910 176.340393,337.495697 C173.613007,322.982056 174.739685,308.521393 180.566284,294.861481 C186.553925,280.824066 186.780304,266.755249 182.229401,252.496246 C176.880325,235.736450 165.471558,223.235016 152.257233,211.236725 M241.118744,208.245575 C239.749130,209.786362 238.379517,211.327148 236.985458,212.895447 C262.901520,232.763733 290.633514,223.471542 306.416840,202.851715 C318.281067,187.351913 316.226044,157.054550 304.153473,141.622360 C302.847260,139.952652 301.232758,138.331650 299.410522,137.319443 C297.973572,136.521240 295.996857,136.694809 294.259888,136.436783 C294.181244,137.974777 293.871643,139.541946 294.061523,141.046051 C295.286072,150.744232 297.562958,160.413269 297.721161,170.120773 C298.049957,190.294220 288.133545,201.883621 268.303741,205.152786 C261.495789,206.275177 254.391632,205.515747 247.437820,205.893005 C245.498154,205.998260 243.612152,207.092804 241.118744,208.245575 M157.203583,142.704254 C157.579285,140.668564 157.954987,138.632874 158.374847,136.357986 C153.247375,135.288956 150.531830,138.003983 148.252747,141.070709 C142.620224,148.649857 140.573257,157.512756 139.446167,166.694946 C135.853882,195.960144 156.236328,213.607132 180.934296,216.106140 C191.876221,217.213287 201.551514,213.023224 210.522369,206.337082 C206.981735,201.838913 203.996735,198.795944 197.851685,199.635071 C192.030167,200.430038 185.868652,199.762115 179.985764,198.878204 C165.354172,196.679779 155.992783,187.480423 155.060028,172.704514 C154.451569,163.065933 156.298599,153.272324 157.203583,142.704254 M194.757828,156.715408 C187.345032,151.616898 180.027786,152.604660 175.774719,159.278030 C171.874695,165.397385 173.905182,173.252197 180.327469,176.890152 C185.033401,179.555862 191.749298,178.498306 195.436081,174.429794 C198.784195,170.735031 200.957657,163.616745 194.757828,156.715408 M258.894440,156.301392 C254.016190,161.726913 253.072845,166.972702 256.058044,172.074188 C259.539368,178.023514 267.119171,180.161209 272.926941,176.831635 C279.083771,173.301941 281.209137,165.510529 277.627899,159.598328 C273.714417,153.137650 266.535950,151.674973 258.894440,156.301392 M225.439148,182.025024 C222.943115,182.025085 220.439667,182.147156 217.952789,181.996307 C214.315170,181.775665 213.739273,183.163116 214.827789,186.467941 C217.266769,193.872864 219.353851,201.393204 221.640366,208.849335 C222.022400,210.095078 222.686813,211.254196 223.220734,212.453354 C223.723679,212.420837 224.226608,212.388321 224.729538,212.355804 C227.667816,202.542328 230.606079,192.728867 233.810944,182.025024 C230.617004,182.025024 228.505814,182.025024 225.439148,182.025024z"/></svg></div>
        <h2>Administration</h2>
      </div>
      <button class="btn btn-ghost btn-sm" onclick="doLogout()">Sign Out</button>
    </div>

    <!-- Add User -->
    <div class="panel-section">
      <h3 class="mb-12">Add Operative</h3>
      <div class="flex-row" style="gap:10px;flex-wrap:wrap">
        <div class="field" style="flex:1;min-width:140px;margin-bottom:0"><input id="newUser" placeholder="Username"></div>
        <div class="field" style="flex:1;min-width:140px;margin-bottom:0"><input id="newPass" type="password" placeholder="Password"></div>
        <button class="btn btn-primary btn-sm" onclick="addUser()">Add</button>
      </div>
      <div class="error-msg" id="adminErr"></div>
    </div>

    <!-- User List -->
    <div style="max-height:240px;overflow-y:auto">
      <table class="user-table">
        <thead><tr><th>Operative</th><th>Status</th><th>Action</th></tr></thead>
        <tbody id="userTableBody"></tbody>
      </table>
    </div>

    <!-- Change Admin Pass -->
    <div class="panel-section" style="margin-top:16px;margin-bottom:0">
      <h3 class="mb-12">Change Admin Password</h3>
      <div class="flex-row" style="gap:10px">
        <div class="field" style="flex:1;margin-bottom:0"><input id="newAdminPass" type="password" placeholder="New password"></div>
        <button class="btn btn-danger btn-sm" onclick="changeAdminPass()">Update</button>
      </div>
      <div class="error-msg" id="adminPassErr"></div>
    </div>
  </div>
</div>

<!-- ═══════════ ASSESSMENT SCREEN ═══════════ -->
<div class="screen" id="assessScreen">
  <div class="card card-wide">
    <div class="flex-row" style="justify-content:space-between;margin-bottom:4px">
      <div class="flex-row">
        <div class="logo-icon"><svg viewBox="30 0 390 394" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="#E80101" d="M318.662415,46.329861 C350.975952,67.491737 374.216797,95.626640 388.370758,131.231705 C398.967072,157.887283 402.792847,185.594864 399.831055,213.984909 C395.370728,256.738831 377.631897,293.423401 346.923859,323.595795 C332.141571,338.120239 315.737274,350.485474 296.476776,358.639771 C294.880524,359.315552 293.171204,359.724274 290.571503,360.560364 C295.458649,356.436432 299.876984,353.399139 303.453522,349.574646 C322.485718,329.222961 333.647675,304.988129 337.987640,277.568420 C340.418854,262.208252 340.112366,247.042175 333.774078,232.474167 C329.346283,222.297211 322.891357,213.515106 314.731659,204.628601 C308.419647,210.585602 302.040070,216.091507 296.261139,222.168594 C284.631592,234.398163 275.258301,248.059097 272.571930,265.202026 C270.852905,276.171967 271.698151,286.891266 275.187012,297.671783 C278.022522,306.433594 280.017273,315.713013 280.650726,324.882690 C281.539215,337.744659 280.270691,350.628815 275.871918,363.000366 C274.065613,368.080658 271.121979,369.276764 266.693909,366.306854 C260.521790,362.167206 253.824341,362.953369 248.464661,369.193420 C245.794296,372.302429 242.866608,373.543213 239.033539,373.604645 C235.869644,373.655334 232.681244,373.652222 229.551361,374.048889 C222.770264,374.908356 217.755753,373.600433 213.095581,367.419739 C206.258911,358.352356 195.548355,358.372528 186.842010,366.291077 C184.186798,368.705994 182.073654,369.274567 178.578186,368.368896 C157.726715,362.966370 139.153198,353.071014 120.933342,341.747559 C93.021454,324.400604 74.262184,299.718140 60.725784,270.623108 C46.098583,239.183472 41.764515,206.078857 46.681545,171.740692 C52.117432,133.779099 68.531815,101.248711 94.798172,73.477821 C123.023285,43.635960 157.356934,25.598032 198.068573,20.035879 C241.287415,14.131188 281.392975,23.002148 318.662415,46.329861 M310.763367,124.316849 C312.948181,122.793770 315.146851,121.290184 317.315521,119.744469 C331.609680,109.556480 335.870483,96.270729 330.199249,78.639542 C328.861145,79.312576 327.546997,79.879265 326.325775,80.602821 C317.166168,86.029861 308.068756,91.563370 298.861969,96.908699 C293.064911,100.274376 286.722504,101.638161 280.112152,100.256416 C268.405884,97.809486 256.797211,94.888962 245.075821,92.522522 C223.330276,88.132271 202.121078,88.215576 182.198776,100.093269 C179.499542,101.702545 175.428635,101.693115 172.077698,101.414116 C153.477859,99.865547 138.705322,91.045265 126.903770,76.860123 C125.792709,75.524658 124.584282,74.270203 123.421059,72.978134 C122.906746,73.112480 122.392441,73.246826 121.878128,73.381172 C121.878128,77.431305 122.350616,81.548676 121.785728,85.518425 C120.339378,95.682579 124.747345,103.379227 130.945007,110.780029 C143.795776,126.125488 160.440628,135.712357 179.080978,141.542572 C195.659592,146.727951 209.741806,154.949585 220.740311,168.433060 C222.233841,170.264023 224.343658,171.592239 226.479538,173.419678 C227.733597,171.616974 228.579880,170.420807 229.405518,169.210556 C238.001938,156.609787 248.615250,146.734848 264.039368,143.173401 C280.355499,139.405960 295.686340,133.123657 310.763367,124.316849 M152.257233,211.236725 C148.147202,207.846405 144.145645,204.307068 139.846191,201.176926 C138.847656,200.449951 136.172775,200.454834 135.385223,201.240967 C119.994370,216.604218 109.448463,234.572540 110.426384,256.930267 C112.059555,294.268555 126.122505,326.001801 156.209335,349.309540 C163.636627,355.063263 172.264160,359.272675 180.379486,364.125885 C181.236099,364.638153 182.360657,364.702423 184.359070,365.246063 C183.650345,362.667023 183.222290,360.991943 182.729462,359.336182 C180.564224,352.061584 177.734406,344.913910 176.340393,337.495697 C173.613007,322.982056 174.739685,308.521393 180.566284,294.861481 C186.553925,280.824066 186.780304,266.755249 182.229401,252.496246 C176.880325,235.736450 165.471558,223.235016 152.257233,211.236725 M241.118744,208.245575 C239.749130,209.786362 238.379517,211.327148 236.985458,212.895447 C262.901520,232.763733 290.633514,223.471542 306.416840,202.851715 C318.281067,187.351913 316.226044,157.054550 304.153473,141.622360 C302.847260,139.952652 301.232758,138.331650 299.410522,137.319443 C297.973572,136.521240 295.996857,136.694809 294.259888,136.436783 C294.181244,137.974777 293.871643,139.541946 294.061523,141.046051 C295.286072,150.744232 297.562958,160.413269 297.721161,170.120773 C298.049957,190.294220 288.133545,201.883621 268.303741,205.152786 C261.495789,206.275177 254.391632,205.515747 247.437820,205.893005 C245.498154,205.998260 243.612152,207.092804 241.118744,208.245575 M157.203583,142.704254 C157.579285,140.668564 157.954987,138.632874 158.374847,136.357986 C153.247375,135.288956 150.531830,138.003983 148.252747,141.070709 C142.620224,148.649857 140.573257,157.512756 139.446167,166.694946 C135.853882,195.960144 156.236328,213.607132 180.934296,216.106140 C191.876221,217.213287 201.551514,213.023224 210.522369,206.337082 C206.981735,201.838913 203.996735,198.795944 197.851685,199.635071 C192.030167,200.430038 185.868652,199.762115 179.985764,198.878204 C165.354172,196.679779 155.992783,187.480423 155.060028,172.704514 C154.451569,163.065933 156.298599,153.272324 157.203583,142.704254 M194.757828,156.715408 C187.345032,151.616898 180.027786,152.604660 175.774719,159.278030 C171.874695,165.397385 173.905182,173.252197 180.327469,176.890152 C185.033401,179.555862 191.749298,178.498306 195.436081,174.429794 C198.784195,170.735031 200.957657,163.616745 194.757828,156.715408 M258.894440,156.301392 C254.016190,161.726913 253.072845,166.972702 256.058044,172.074188 C259.539368,178.023514 267.119171,180.161209 272.926941,176.831635 C279.083771,173.301941 281.209137,165.510529 277.627899,159.598328 C273.714417,153.137650 266.535950,151.674973 258.894440,156.301392 M225.439148,182.025024 C222.943115,182.025085 220.439667,182.147156 217.952789,181.996307 C214.315170,181.775665 213.739273,183.163116 214.827789,186.467941 C217.266769,193.872864 219.353851,201.393204 221.640366,208.849335 C222.022400,210.095078 222.686813,211.254196 223.220734,212.453354 C223.723679,212.420837 224.226608,212.388321 224.729538,212.355804 C227.667816,202.542328 230.606079,192.728867 233.810944,182.025024 C230.617004,182.025024 228.505814,182.025024 225.439148,182.025024z"/></svg></div>
        <h2>Apollo</h2>
      </div>
      <button class="btn btn-ghost btn-sm" onclick="doLogout()">Sign Out</button>
    </div>
    <div class="progress-bar"><div class="fill" id="progressFill" style="width:0%"></div></div>

    <div class="assess-container" id="assessContainer">
      <!-- Step 0: Subject Intake -->
      <div class="assess-step active" id="step0">
        <h3 class="mb-16">Subject Intake</h3>
        <div class="field"><label>Subject Name / Identifier</label><input id="suspectName" placeholder="Enter subject name"></div>
        <div class="field"><label>Assessment Period (Days)</label><input id="assessPeriod" type="number" min="1" max="30" value="7" placeholder="1-30"></div>
        <div class="field"><label>Jurisdiction</label><input id="jurisdiction" placeholder="Enter jurisdiction"></div>
        <div class="field"><label>Investigating Operative</label><input id="investigator" readonly></div>
      </div>

      <!-- Step 1: Section 1 Conduct -->
      <div class="assess-step" id="step1" style="display:none">
        <h3 class="mb-16">Section One — Conduct</h3>
        <div class="q-block" id="q1_1_block">
          <div class="q-id">1.1</div>
          <div class="q-text">Has the suspect been exhibiting negative behavior in their contact with your service?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_1',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q1_1',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q1_2_block">
          <div class="q-id">1.2</div>
          <div class="q-text">Has the suspect been exhibiting negative behavior towards members of the general population?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_2',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q1_2',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q1_2d_block">
          <div class="q-id">1.2 — Supplementary</div>
          <div class="q-text">Has the suspect acted discriminatorily towards any member for their association with or membership within a protected class in your jurisdiction?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_2d',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q1_2d',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q1_slur_block">
          <div class="q-id">1 — Slurs Addendum</div>
          <div class="q-text">Has the suspect used slurs in their speech during the term of investigation?</div>
          <div class="q-note">This does not include commonly understood expletive phrases, but a pejorative, derogatory, or insulting word/phrase designed to demean, belittle, or show contempt toward individuals or groups based on race, ethnicity, sexual orientation, gender, or other characteristics.</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q1_slur',true,this)">Yes (+2)</div><div class="yn-btn" onclick="setYN('q1_slur',false,this)">No</div></div>
        </div>
      </div>

      <!-- Step 2: Section 2 Prior Offences -->
      <div class="assess-step" id="step2" style="display:none">
        <h3 class="mb-16">Section Two — Prior Offences</h3>
        <div class="q-block" id="q2_1_block">
          <div class="q-id">2.1</div>
          <div class="q-text">Has the suspect been convicted of any prior offenses inside or outside of your jurisdiction?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_1',true,this)">Yes</div><div class="yn-btn" onclick="setYN('q2_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_2_block">
          <div class="q-id">2.2</div>
          <div class="q-text">How many times has the suspect been convicted?</div>
          <div class="field" style="margin-bottom:0;margin-top:8px"><input id="q2_convictions" type="number" min="1" max="50" value="1" onchange="buildSeverityInputs()" oninput="buildSeverityInputs()"></div>
        </div>
        <div class="q-block hidden" id="q2_3_block">
          <div class="q-id">2.3</div>
          <div class="q-text">Rate the severity of each offense (0 = minimal, 1 = maximum severity):</div>
          <div id="severityContainer"></div>
        </div>
        <div class="q-block hidden" id="q2_4_block">
          <div class="q-id">2.4</div>
          <div class="q-text">Has the suspect been banned from your jurisdiction for any of these convictions?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4',true,this)">Yes (+2)</div><div class="yn-btn" onclick="setYN('q2_4',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_4_1_block">
          <div class="q-id">2.4.1</div>
          <div class="q-text">Has the suspect been banned for more than two months?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4_1',true,this)">Yes (+0.5)</div><div class="yn-btn" onclick="setYN('q2_4_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_4_2_block">
          <div class="q-id">2.4.2</div>
          <div class="q-text">Has the suspect been banned for more than six months?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4_2',true,this)">Yes (+1.0)</div><div class="yn-btn" onclick="setYN('q2_4_2',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_4_3_block">
          <div class="q-id">2.4.3</div>
          <div class="q-text">Has the suspect been banned for more than one year?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_4_3',true,this)">Yes (+2.5)</div><div class="yn-btn" onclick="setYN('q2_4_3',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q2_5_block">
          <div class="q-id">2.5</div>
          <div class="q-text">Has the suspect been convicted prior to this assessment period for the suspected crime?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q2_5',true,this)">Yes (+1.5)</div><div class="yn-btn" onclick="setYN('q2_5',false,this)">No</div></div>
        </div>
      </div>

      <!-- Step 3: Section 3 Demeanour -->
      <div class="assess-step" id="step3" style="display:none">
        <h3 class="mb-16">Section Three — Demeanour</h3>
        <div class="q-block" id="q3_1_block">
          <div class="q-id">3.1</div>
          <div class="q-text">Has the suspect been acting in a manner that is different from their usual demeanor?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q3_1',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q3_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q3_1_1_block">
          <div class="q-id">3.1.1</div>
          <div class="q-text">Does this shift in demeanour have a reasonable and known or documented explanation?</div>
          <div class="q-note">If yes, subtract 1 point. If no, add 1.5 points.</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q3_1_1',true,this)">Yes (-1)</div><div class="yn-btn" onclick="setYN('q3_1_1',false,this)">No (+1.5)</div></div>
        </div>
      </div>

      <!-- Step 4: Section 4 Mediating Factors -->
      <div class="assess-step" id="step4" style="display:none">
        <h3 class="mb-16">Section Four — Mediating Factors</h3>
        <div class="q-block" id="q4_1_block">
          <div class="q-id">4.1</div>
          <div class="q-text">At the time of investigation, was or is the suspect a member of your government?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_1',true,this)">Yes (-1)</div><div class="yn-btn" onclick="setYN('q4_1',false,this)">No</div></div>
        </div>
        <div class="q-block hidden" id="q4_1_1_block">
          <div class="q-id">4.1.1</div>
          <div class="q-text">Is the suspect being investigated for crimes committed while in office?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_1_1',true,this)">Yes (+1)</div><div class="yn-btn" onclick="setYN('q4_1_1',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q4_2_block">
          <div class="q-id">4.2</div>
          <div class="q-text">Is the suspect generally well liked, not just by you, but by the jurisdiction's community?</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_2',true,this)">Yes (-1)</div><div class="yn-btn" onclick="setYN('q4_2',false,this)">No</div></div>
        </div>
        <div class="q-block" id="q4_3_block">
          <div class="q-id">4.3</div>
          <div class="q-text">If the investigation was initiated because of general knowledge that a crime has been committed, or the mere suspicion a crime has been committed without direct evidence, which you aim to gain through further investigation:</div>
          <div class="q-note">If yes, subtract 3 points. This accounts for low-evidence preliminary investigations.</div>
          <div class="yn-group"><div class="yn-btn" onclick="setYN('q4_3',true,this)">Yes (-3)</div><div class="yn-btn" onclick="setYN('q4_3',false,this)">No</div></div>
        </div>
      </div>
    </div>

    <!-- NAV -->
    <div class="flex-row mt-20" style="justify-content:space-between" id="assessNav">
      <button class="btn btn-secondary btn-sm" id="prevBtn" onclick="assessNav(-1)" style="visibility:hidden">&larr; Previous</button>
      <button class="btn btn-primary btn-sm" id="nextBtn" onclick="assessNav(1)">Next &rarr;</button>
    </div>
  </div>
</div>

<!-- ═══════════ RESULTS SCREEN ═══════════ -->
<div class="screen" id="resultScreen">
  <div class="card card-wide" id="resultPanel">
    <div class="text-center mb-16">
      <div class="logo"><svg viewBox="0 0 1268 394" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="#E80101" d="M318.662415,46.329861 C350.975952,67.491737 374.216797,95.626640 388.370758,131.231705 C398.967072,157.887283 402.792847,185.594864 399.831055,213.984909 C395.370728,256.738831 377.631897,293.423401 346.923859,323.595795 C332.141571,338.120239 315.737274,350.485474 296.476776,358.639771 C294.880524,359.315552 293.171204,359.724274 290.571503,360.560364 C295.458649,356.436432 299.876984,353.399139 303.453522,349.574646 C322.485718,329.222961 333.647675,304.988129 337.987640,277.568420 C340.418854,262.208252 340.112366,247.042175 333.774078,232.474167 C329.346283,222.297211 322.891357,213.515106 314.731659,204.628601 C308.419647,210.585602 302.040070,216.091507 296.261139,222.168594 C284.631592,234.398163 275.258301,248.059097 272.571930,265.202026 C270.852905,276.171967 271.698151,286.891266 275.187012,297.671783 C278.022522,306.433594 280.017273,315.713013 280.650726,324.882690 C281.539215,337.744659 280.270691,350.628815 275.871918,363.000366 C274.065613,368.080658 271.121979,369.276764 266.693909,366.306854 C260.521790,362.167206 253.824341,362.953369 248.464661,369.193420 C245.794296,372.302429 242.866608,373.543213 239.033539,373.604645 C235.869644,373.655334 232.681244,373.652222 229.551361,374.048889 C222.770264,374.908356 217.755753,373.600433 213.095581,367.419739 C206.258911,358.352356 195.548355,358.372528 186.842010,366.291077 C184.186798,368.705994 182.073654,369.274567 178.578186,368.368896 C157.726715,362.966370 139.153198,353.071014 120.933342,341.747559 C93.021454,324.400604 74.262184,299.718140 60.725784,270.623108 C46.098583,239.183472 41.764515,206.078857 46.681545,171.740692 C52.117432,133.779099 68.531815,101.248711 94.798172,73.477821 C123.023285,43.635960 157.356934,25.598032 198.068573,20.035879 C241.287415,14.131188 281.392975,23.002148 318.662415,46.329861 M310.763367,124.316849 C312.948181,122.793770 315.146851,121.290184 317.315521,119.744469 C331.609680,109.556480 335.870483,96.270729 330.199249,78.639542 C328.861145,79.312576 327.546997,79.879265 326.325775,80.602821 C317.166168,86.029861 308.068756,91.563370 298.861969,96.908699 C293.064911,100.274376 286.722504,101.638161 280.112152,100.256416 C268.405884,97.809486 256.797211,94.888962 245.075821,92.522522 C223.330276,88.132271 202.121078,88.215576 182.198776,100.093269 C179.499542,101.702545 175.428635,101.693115 172.077698,101.414116 C153.477859,99.865547 138.705322,91.045265 126.903770,76.860123 C125.792709,75.524658 124.584282,74.270203 123.421059,72.978134 C122.906746,73.112480 122.392441,73.246826 121.878128,73.381172 C121.878128,77.431305 122.350616,81.548676 121.785728,85.518425 C120.339378,95.682579 124.747345,103.379227 130.945007,110.780029 C143.795776,126.125488 160.440628,135.712357 179.080978,141.542572 C195.659592,146.727951 209.741806,154.949585 220.740311,168.433060 C222.233841,170.264023 224.343658,171.592239 226.479538,173.419678 C227.733597,171.616974 228.579880,170.420807 229.405518,169.210556 C238.001938,156.609787 248.615250,146.734848 264.039368,143.173401 C280.355499,139.405960 295.686340,133.123657 310.763367,124.316849 M152.257233,211.236725 C148.147202,207.846405 144.145645,204.307068 139.846191,201.176926 C138.847656,200.449951 136.172775,200.454834 135.385223,201.240967 C119.994370,216.604218 109.448463,234.572540 110.426384,256.930267 C112.059555,294.268555 126.122505,326.001801 156.209335,349.309540 C163.636627,355.063263 172.264160,359.272675 180.379486,364.125885 C181.236099,364.638153 182.360657,364.702423 184.359070,365.246063 C183.650345,362.667023 183.222290,360.991943 182.729462,359.336182 C180.564224,352.061584 177.734406,344.913910 176.340393,337.495697 C173.613007,322.982056 174.739685,308.521393 180.566284,294.861481 C186.553925,280.824066 186.780304,266.755249 182.229401,252.496246 C176.880325,235.736450 165.471558,223.235016 152.257233,211.236725 M241.118744,208.245575 C239.749130,209.786362 238.379517,211.327148 236.985458,212.895447 C262.901520,232.763733 290.633514,223.471542 306.416840,202.851715 C318.281067,187.351913 316.226044,157.054550 304.153473,141.622360 C302.847260,139.952652 301.232758,138.331650 299.410522,137.319443 C297.973572,136.521240 295.996857,136.694809 294.259888,136.436783 C294.181244,137.974777 293.871643,139.541946 294.061523,141.046051 C295.286072,150.744232 297.562958,160.413269 297.721161,170.120773 C298.049957,190.294220 288.133545,201.883621 268.303741,205.152786 C261.495789,206.275177 254.391632,205.515747 247.437820,205.893005 C245.498154,205.998260 243.612152,207.092804 241.118744,208.245575 M157.203583,142.704254 C157.579285,140.668564 157.954987,138.632874 158.374847,136.357986 C153.247375,135.288956 150.531830,138.003983 148.252747,141.070709 C142.620224,148.649857 140.573257,157.512756 139.446167,166.694946 C135.853882,195.960144 156.236328,213.607132 180.934296,216.106140 C191.876221,217.213287 201.551514,213.023224 210.522369,206.337082 C206.981735,201.838913 203.996735,198.795944 197.851685,199.635071 C192.030167,200.430038 185.868652,199.762115 179.985764,198.878204 C165.354172,196.679779 155.992783,187.480423 155.060028,172.704514 C154.451569,163.065933 156.298599,153.272324 157.203583,142.704254 M194.757828,156.715408 C187.345032,151.616898 180.027786,152.604660 175.774719,159.278030 C171.874695,165.397385 173.905182,173.252197 180.327469,176.890152 C185.033401,179.555862 191.749298,178.498306 195.436081,174.429794 C198.784195,170.735031 200.957657,163.616745 194.757828,156.715408 M258.894440,156.301392 C254.016190,161.726913 253.072845,166.972702 256.058044,172.074188 C259.539368,178.023514 267.119171,180.161209 272.926941,176.831635 C279.083771,173.301941 281.209137,165.510529 277.627899,159.598328 C273.714417,153.137650 266.535950,151.674973 258.894440,156.301392 M225.439148,182.025024 C222.943115,182.025085 220.439667,182.147156 217.952789,181.996307 C214.315170,181.775665 213.739273,183.163116 214.827789,186.467941 C217.266769,193.872864 219.353851,201.393204 221.640366,208.849335 C222.022400,210.095078 222.686813,211.254196 223.220734,212.453354 C223.723679,212.420837 224.226608,212.388321 224.729538,212.355804 C227.667816,202.542328 230.606079,192.728867 233.810944,182.025024 C230.617004,182.025024 228.505814,182.025024 225.439148,182.025024z"/></svg></div>
    </div>
    <div id="resultContent"></div>
    <div class="flex-row mt-24" style="justify-content:center;gap:12px">
      <button class="btn btn-primary btn-sm" onclick="newAssessment()">New Assessment</button>
      <button class="btn btn-secondary btn-sm" onclick="printResult()">Export Report</button>
    </div>
  </div>
</div>

<script>
// ═══════════════════════════════════════
//  APOLLO FRAMEWORK — CORE ENGINE
//  Version One: Corvus (Server-Side Auth)
// ═══════════════════════════════════════

// ╔═══════════════════════════════════════════════════════════╗
// ║  PASTE YOUR APPS SCRIPT DEPLOYMENT URL BELOW             ║
// ╚═══════════════════════════════════════════════════════════╝
const API_URL = 'https://script.google.com/macros/s/AKfycbwBgQtsL7uavYTMd2PacrZA__nijMI0MsrRUX0L2rfeLj5ofVRg-hYDc3NFexdhRLJY/exec';

const TOKEN_KEY = 'apollo_session_token';

// ── API HELPER ──
async function api(action, params = {}) {
  const body = Object.assign({ action }, params);
  const token = localStorage.getItem(TOKEN_KEY);
  if (token) body.token = token;
  const res = await fetch(API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
    body: JSON.stringify(body)
  });
  return res.json();
}

// ── BUTTON LOADING STATES ──
function btnLoading(btn, loading) {
  if (loading) {
    btn.dataset.origText = btn.textContent;
    btn.textContent = 'Processing...';
    btn.disabled = true;
    btn.style.opacity = '0.5';
  } else {
    btn.textContent = btn.dataset.origText || btn.textContent;
    btn.disabled = false;
    btn.style.opacity = '1';
  }
}

// ── INIT ──
async function init() {
  document.getElementById('loginUser').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });
  document.getElementById('loginPass').addEventListener('keydown', e => { if (e.key === 'Enter') doLogin(); });

  const token = localStorage.getItem(TOKEN_KEY);
  if (token) {
    try {
      const res = await api('validate', { token });
      if (res.ok) {
        currentUser = res.username;
        currentRole = res.role;
        if (res.role === 'admin') { showScreen('adminScreen'); refreshUserTable(); }
        else { document.getElementById('investigator').value = res.username; showScreen('assessScreen'); }
      } else {
        localStorage.removeItem(TOKEN_KEY);
      }
    } catch (e) {
      localStorage.removeItem(TOKEN_KEY);
    }
  }

  setTimeout(() => { document.getElementById('loadingOverlay').classList.add('fade-out'); }, 600);
}

let currentUser = null;
let currentRole = null;
let currentStep = 0;
const totalSteps = 5;
let answers = {};

// ── AUTH ──
async function doLogin() {
  const u = document.getElementById('loginUser').value.trim();
  const p = document.getElementById('loginPass').value;
  const err = document.getElementById('loginErr');
  err.textContent = '';
  if (!u || !p) { err.textContent = 'All fields required.'; return; }

  const btn = document.querySelector('#loginScreen .btn-primary');
  btnLoading(btn, true);

  try {
    const res = await api('login', { username: u, password: p });
    if (res.ok) {
      localStorage.setItem(TOKEN_KEY, res.token);
      currentUser = u;
      currentRole = res.role;
      if (res.role === 'admin') { showScreen('adminScreen'); refreshUserTable(); }
      else { document.getElementById('investigator').value = u; showScreen('assessScreen'); }
    } else {
      err.textContent = res.error || 'Invalid credentials.';
    }
  } catch (e) {
    err.textContent = 'Unable to reach server.';
  } finally {
    btnLoading(btn, false);
  }
}

async function doLogout() {
  const btn = event ? event.target : null;
  if (btn) btnLoading(btn, true);

  try { await api('logout'); } catch (e) {}

  localStorage.removeItem(TOKEN_KEY);
  currentUser = null;
  currentRole = null;
  resetAssessment();
  showScreen('loginScreen');
  document.getElementById('loginUser').value = '';
  document.getElementById('loginPass').value = '';
  document.getElementById('loginErr').textContent = '';
  if (btn) btnLoading(btn, false);
}

// ── ADMIN ──
async function addUser() {
  const u = document.getElementById('newUser').value.trim();
  const p = document.getElementById('newPass').value;
  const err = document.getElementById('adminErr');
  err.textContent = '';
  if (!u || !p) { err.textContent = 'Username and password required.'; return; }

  const btn = document.querySelector('#adminScreen .btn-primary');
  btnLoading(btn, true);

  try {
    const res = await api('adduser', { username: u, password: p });
    if (res.ok) {
      document.getElementById('newUser').value = '';
      document.getElementById('newPass').value = '';
      refreshUserTable();
    } else {
      err.textContent = res.error || 'Failed to add user.';
    }
  } catch (e) {
    err.textContent = 'Unable to reach server.';
  } finally {
    btnLoading(btn, false);
  }
}

async function removeUser(username) {
  try {
    const res = await api('removeuser', { username });
    if (!res.ok) { alert(res.error || 'Failed to remove user.'); }
    refreshUserTable();
  } catch (e) {
    alert('Unable to reach server.');
  }
}

async function changeAdminPass() {
  const p = document.getElementById('newAdminPass').value;
  const err = document.getElementById('adminPassErr');
  err.textContent = '';
  err.style.color = '';
  if (!p || p.length < 4) { err.textContent = 'Password must be at least 4 characters.'; return; }

  const btn = document.querySelector('#adminScreen .btn-danger');
  btnLoading(btn, true);

  try {
    const res = await api('changeadminpass', { newPassword: p });
    if (res.ok) {
      document.getElementById('newAdminPass').value = '';
      err.style.color = 'var(--green)';
      err.textContent = 'Password updated.';
      setTimeout(() => { err.textContent = ''; err.style.color = ''; }, 2000);
    } else {
      err.textContent = res.error || 'Failed to update password.';
    }
  } catch (e) {
    err.textContent = 'Unable to reach server.';
  } finally {
    btnLoading(btn, false);
  }
}

async function refreshUserTable() {
  const tbody = document.getElementById('userTableBody');
  tbody.innerHTML = '<tr><td colspan="3" style="color:var(--text-tertiary);text-align:center;padding:20px">Loading...</td></tr>';

  try {
    const res = await api('listusers');
    tbody.innerHTML = '';
    if (!res.ok) { tbody.innerHTML = '<tr><td colspan="3" style="color:var(--danger);text-align:center">' + (res.error || 'Error') + '</td></tr>'; return; }
    const users = res.users.filter(u => u.role !== 'admin');
    if (!users.length) { tbody.innerHTML = '<tr><td colspan="3" style="color:var(--text-tertiary);text-align:center;padding:20px">No operatives registered</td></tr>'; return; }
    users.forEach(u => {
      const tr = document.createElement('tr');
      const safeName = u.username.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c]));
      tr.innerHTML = '<td>' + safeName + '</td><td><span class="badge badge-active">Active</span></td><td><button class="btn btn-danger btn-sm" onclick="removeUser(\'' + safeName.replace(/'/g, "\\'") + '\')">Remove</button></td>';
      tbody.appendChild(tr);
    });
  } catch (e) {
    tbody.innerHTML = '<tr><td colspan="3" style="color:var(--danger);text-align:center">Connection error</td></tr>';
  }
}

// ── SCREEN NAV ──
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// ── ASSESSMENT NAV ──
function assessNav(dir) {
  const newStep = currentStep + dir;
  if (newStep < 0) return;
  if (newStep > 4) { computeResult(); return; }
  document.getElementById('step' + currentStep).style.display = 'none';
  currentStep = newStep;
  document.getElementById('step' + currentStep).style.display = 'block';
  document.getElementById('prevBtn').style.visibility = currentStep === 0 ? 'hidden' : 'visible';
  document.getElementById('nextBtn').textContent = currentStep === 4 ? 'Finalize Assessment' : 'Next \u2192';
  document.getElementById('progressFill').style.width = ((currentStep + 1) / totalSteps * 100) + '%';
  document.getElementById('assessContainer').scrollTop = 0;
}

// ── YES/NO TOGGLE ──
function setYN(key, val, el) {
  answers[key] = val;
  const grp = el.parentElement;
  grp.querySelectorAll('.yn-btn').forEach(b => { b.classList.remove('sel-yes','sel-no'); });
  el.classList.add(val ? 'sel-yes' : 'sel-no');
  handleConditionals(key, val);
}
function handleConditionals(key, val) {
  const show = (id, v) => { document.getElementById(id).classList.toggle('hidden', !v); };
  if (key === 'q1_2') { show('q1_2d_block', val); if (!val) answers.q1_2d = false; }
  if (key === 'q2_1') {
    show('q2_2_block', val); show('q2_3_block', val); show('q2_4_block', val); show('q2_5_block', val);
    if (val) buildSeverityInputs();
    else { answers.q2_4 = false; answers.q2_4_1 = false; answers.q2_4_2 = false; answers.q2_4_3 = false; answers.q2_5 = false;
      ['q2_4_1_block','q2_4_2_block','q2_4_3_block'].forEach(id => document.getElementById(id).classList.add('hidden')); }
  }
  if (key === 'q2_4') { show('q2_4_1_block', val); if (!val) { answers.q2_4_1 = false; answers.q2_4_2 = false; answers.q2_4_3 = false;
    ['q2_4_2_block','q2_4_3_block'].forEach(id => document.getElementById(id).classList.add('hidden')); } }
  if (key === 'q2_4_1') { show('q2_4_2_block', val); if (!val) { answers.q2_4_2 = false; answers.q2_4_3 = false; document.getElementById('q2_4_3_block').classList.add('hidden'); } }
  if (key === 'q2_4_2') { show('q2_4_3_block', val); if (!val) answers.q2_4_3 = false; }
  if (key === 'q3_1') { show('q3_1_1_block', val); if (!val) answers.q3_1_1 = undefined; }
  if (key === 'q4_1') { show('q4_1_1_block', val); if (!val) answers.q4_1_1 = false; }
}

// ── SEVERITY SLIDERS ──
function buildSeverityInputs() {
  const n = Math.max(1, Math.min(50, parseInt(document.getElementById('q2_convictions').value) || 1));
  const c = document.getElementById('severityContainer');
  c.innerHTML = '';
  for (let i = 0; i < n; i++) {
    const d = document.createElement('div');
    d.style.cssText = 'display:flex;align-items:center;gap:12px;margin-bottom:8px;padding:8px 12px;background:var(--bg-secondary);border-radius:8px';
    d.innerHTML = `<span style="font-size:13px;font-weight:600;color:var(--red);min-width:80px">Offence ${i+1}</span>
      <input type="range" min="0" max="1" step="0.1" value="0.5" oninput="this.nextElementSibling.textContent=this.value" style="flex:1">
      <span class="severity-val">0.5</span>`;
    c.appendChild(d);
  }
}

// ── SCORING ──
function computeResult() {
  let score = 0;
  const bd = {};

  let s1 = 0;
  if (answers.q1_1) s1 += 1;
  if (answers.q1_2) { s1 += 1; if (answers.q1_2d) s1 += 1; }
  if (answers.q1_slur) s1 += 2;
  bd['Section 1: Conduct'] = s1; score += s1;

  let s2 = 0;
  if (answers.q2_1) {
    const sliders = document.querySelectorAll('#severityContainer input[type=range]');
    sliders.forEach(s => { s2 += parseFloat(s.value); });
    if (answers.q2_4) { s2 += 2; if (answers.q2_4_1) { s2 += 0.5; if (answers.q2_4_2) { s2 += 1; if (answers.q2_4_3) s2 += 2.5; } } }
    if (answers.q2_5) s2 += 1.5;
  }
  bd['Section 2: Prior Offences'] = s2; score += s2;

  let s3 = 0;
  if (answers.q3_1) { s3 += 1; if (answers.q3_1_1 === true) s3 -= 1; else if (answers.q3_1_1 === false) s3 += 1.5; }
  bd['Section 3: Demeanour'] = s3; score += s3;

  let s4 = 0;
  if (answers.q4_1) { s4 -= 1; if (answers.q4_1_1) s4 += 1; }
  if (answers.q4_2) s4 -= 1;
  if (answers.q4_3) s4 -= 3;
  bd['Section 4: Mediating Factors'] = s4; score += s4;

  score = Math.round(score * 10) / 10;
  let level, desc, cls;
  if (score <= 5) { level = 1; desc = 'No Risk Present'; cls = '1'; }
  else if (score <= 10) { level = 2; desc = 'Potential Risk'; cls = '2'; }
  else if (score <= 15) { level = 3; desc = 'Risk to the Community'; cls = '3'; }
  else if (score <= 20) { level = 4; desc = 'Substantial Risk'; cls = '4'; }
  else { level = 5; desc = 'Danger to the Community'; cls = '5'; }

  showScreen('resultScreen');
  animateResult(score, level, desc, cls, bd);
}

function animateResult(score, level, desc, cls, bd) {
  const rc = document.getElementById('resultContent');
  const panel = document.getElementById('resultPanel');
  rc.innerHTML = `<div class="text-center">
    <p style="font-size:13px;font-weight:500;color:var(--text-tertiary);text-transform:uppercase;letter-spacing:.1em" id="analysisText"></p>
    <div id="scoreReveal" style="opacity:0;margin-top:20px">
      <div style="display:flex;align-items:baseline;justify-content:center;gap:24px"><span class="caption">ARLA Score</span><span class="result-level-desc" id="levelDesc" style="opacity:0"></span></div>
      <div style="display:flex;align-items:baseline;justify-content:center;gap:24px"><span class="result-score" id="scoreNum">0</span><span class="result-level-num risk-${cls}" id="levelNum" style="font-size:56px;opacity:0"></span></div>
    </div></div>
    <div id="breakdownReveal" style="opacity:0">
      <div class="result-breakdown">
        <div class="caption mb-8">Score Breakdown</div>
        <div class="rb-row"><span>Subject</span><span>${document.getElementById('suspectName').value || 'N/A'}</span></div>
        <div class="rb-row"><span>Jurisdiction</span><span>${document.getElementById('jurisdiction').value || 'N/A'}</span></div>
        <div class="rb-row"><span>Period</span><span>${document.getElementById('assessPeriod').value || '7'} days</span></div>
        <div class="rb-row"><span>Investigator</span><span>${currentUser}</span></div>
        <div style="height:8px"></div>
        ${Object.entries(bd).map(([k,v]) => `<div class="rb-row"><span>${k}</span><span>${v >= 0 ? '+' : ''}${v}</span></div>`).join('')}
        <div style="height:1px;background:var(--border-light);margin:8px 0"></div>
        <div class="rb-row" style="border:none"><span style="font-weight:700;color:var(--text)">Total ARLA Score</span><span style="font-size:18px;font-weight:700">${score}</span></div>
      </div>
    </div>`;

  let i = 0;
  const txt = 'Analysis Complete';
  const typeEl = document.getElementById('analysisText');
  const typeInterval = setInterval(() => { typeEl.textContent = txt.slice(0, ++i); if (i >= txt.length) clearInterval(typeInterval); }, 40);

  setTimeout(() => {
    const scoreEl = document.getElementById('scoreNum');
    const reveal1 = document.getElementById('scoreReveal');
    reveal1.style.transition = 'opacity .5s'; reveal1.style.opacity = '1';
    let cur = -2; const target = score;
    const step = target > 0 ? 0.1 : -0.1;
    const counter = setInterval(() => {
      cur = Math.round((cur + step) * 10) / 10;
      scoreEl.textContent = cur.toFixed(1);
      if ((step > 0 && cur >= target) || (step < 0 && cur <= target) || (target === 0 && cur >= 0)) { scoreEl.textContent = target.toFixed(1); clearInterval(counter); }
    }, 30);
  }, 1000);

  setTimeout(() => {
    const levelNum = document.getElementById('levelNum');
    const levelDesc = document.getElementById('levelDesc');
    levelNum.textContent = 'Level ' + level;
    levelDesc.textContent = desc;
    levelNum.style.transition = 'opacity .6s'; levelNum.style.opacity = '1';
    levelDesc.style.transition = 'opacity .6s'; levelDesc.style.opacity = '1';
  }, 2000);

  setTimeout(() => {
    const reveal3 = document.getElementById('breakdownReveal');
    reveal3.style.transition = 'opacity .6s'; reveal3.style.opacity = '1';
  }, 2800);
}

// ── UTILITIES ──
function newAssessment() { resetAssessment(); showScreen('assessScreen'); }
function resetAssessment() {
  currentStep = 0; answers = {};
  for (let i = 0; i <= 4; i++) { document.getElementById('step' + i).style.display = i === 0 ? 'block' : 'none'; }
  document.getElementById('progressFill').style.width = '0%';
  document.getElementById('prevBtn').style.visibility = 'hidden';
  document.getElementById('nextBtn').textContent = 'Next \u2192';
  document.querySelectorAll('.yn-btn').forEach(b => b.classList.remove('sel-yes','sel-no'));
  ['q1_2d_block','q2_2_block','q2_3_block','q2_4_block','q2_4_1_block','q2_4_2_block','q2_4_3_block','q2_5_block','q3_1_1_block','q4_1_1_block'].forEach(id => document.getElementById(id).classList.add('hidden'));
  document.getElementById('suspectName').value = '';
  document.getElementById('assessPeriod').value = '7';
  document.getElementById('jurisdiction').value = '';
  document.getElementById('investigator').value = currentUser || '';
  document.getElementById('severityContainer').innerHTML = '';
  document.getElementById('q2_convictions').value = '1';
}
function printResult() {
  const content = document.getElementById('resultPanel').innerHTML;
  const w = window.open('', '_blank');
  w.document.write(`<!DOCTYPE html><html><head><title>Apollo Assessment Report</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>*{margin:0;padding:0;box-sizing:border-box}body{background:#fff;color:#1d1d1f;font-family:'Inter',system-ui,sans-serif;padding:40px;font-size:14px;-webkit-font-smoothing:antialiased}
    .card{max-width:600px;margin:0 auto}
    .logo{width:64px;height:64px;margin:0 auto 16px}.logo svg{width:100%;height:100%}
    .result-score{font-size:56px;font-weight:700;color:#1d1d1f}.result-level-num{font-size:72px;font-weight:800}
    .result-level-desc{font-size:17px;font-weight:600;letter-spacing:.02em;text-transform:uppercase;margin-top:8px;color:#6e6e73}
    .risk-1{color:#43a047}.risk-2{color:#f9a825}.risk-3{color:#ef6c00}.risk-4{color:#e53935}.risk-5{color:#d32f2f}
    .result-breakdown{text-align:left;margin-top:24px;padding:20px;border:1px solid #e8e8ed;border-radius:12px;font-size:14px}
    .rb-row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #e8e8ed}
    .rb-row:last-child{border-bottom:none}
    .rb-row span:first-child{color:#6e6e73}.rb-row span:last-child{font-weight:600}
    .caption{font-size:12px;color:#86868b;font-weight:500;text-transform:uppercase;letter-spacing:.06em}
    .text-center{text-align:center}.btn{display:none}.mb-8{margin-bottom:8px}</style></head><body>${content}
    <p style="text-align:center;margin-top:32px;font-size:11px;color:#86868b">Arrephoros Technologies PLC — Confidential</p></body></html>`);
  w.document.close(); w.focus(); setTimeout(() => w.print(), 500);
}

// ── BOOT ──
window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
